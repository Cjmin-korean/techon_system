<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>영업수주등록</title>
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="../css/main.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://code.jquery.com/ui/1.13.1/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.1/themes/base/jquery-ui.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
</head>
<style>
    input[type="text"] {
        width: 100px;
        /* 텍스트 상자의 너비 */
        padding: 4px;
        /* 텍스트 상자의 패딩 */
        border: 1px solid #ccc;
        /* 테두리 스타일과 색상 */
        border-radius: 4px;
        /* 테두리의 둥근 정도 */
        font-size: 14px;
        /* 글꼴 크기 */
        /* 추가적인 스타일을 여기에 추가할 수 있습니다. */
    }

    input[type="checkbox"] {
        width: 20px;
        /* 너비 조정 */
        height: 20px;
        /* 높이 조정 */
    }

    input[type="file"] {
        width: 200px;
        /* 텍스트 상자의 너비 */
        padding: 4px;
        /* 텍스트 상자의 패딩 */
        border: 1px solid #ccc;
        /* 테두리 스타일과 색상 */
        border-radius: 4px;
        /* 테두리의 둥근 정도 */
        font-size: 12px;
        /* 글꼴 크기 */
        /* 추가적인 스타일을 여기에 추가할 수 있습니다. */
        /* background-color: red; */
    }

    #uploadContainer {
        background-color: transparent;
    }

    /* 스타일링을 추가하세요 */
    /* 중복된 데이터를 표시할 스타일 */
    .duplicate-row {
        background-color: red;
        /* 빨간색 배경 */
        color: white;
        /* 흰색 텍스트 */
        font-weight: bold;
        /* 굵은 글씨체 */
    }


    table {
        width: 100%;
        border-collapse: collapse;
    }

    th,
    td {
        border: 1px solid #ccc;
        padding: 8px;
        text-align: center;
    }

    th {
        background-color: #007bff;
        color: #fff;
    }

    button {
        background-color: #4CAF50;
        /* 초록색 배경 */
        color: white;
        /* 흰색 텍스트 */
        padding: 10px 20px;
        /* 내부 여백 설정 */
        font-size: 16px;
        /* 글꼴 크기 설정 */
        border: none;
        /* 테두리 제거 */
        border-radius: 5px;
        /* 테두리 둥글게 만들기 */
        cursor: pointer;
        /* 마우스 커서를 포인터로 변경 */
    }

    button:hover {
        background-color: #45a049;
        /* 마우스 호버 시 배경 색 변경 */
    }

    /* 모달 스타일 */
    .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.7);
        justify-content: center;
        align-items: center;
        z-index: 999;
        /* 모달을 다른 요소 위에 표시하기 위한 z-index 설정 */
    }

    .modal-content {
        background-color: #fff;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
        max-width: 80%;
    }

    #datatablesliting {
        float: left;
        /* 왼쪽에 배치 */
        width: 65%;
        /* 가로 폭의 절반을 차지하도록 설정 */
    }

    #datatablesliting1 {
        float: left;
        /* 왼쪽 테이블의 오른쪽에 배치 */
        width: 35%;
        /* 가로 폭의 절반을 차지하도록 설정 */
    }



    /* 내부 테이블 스타일 */
    .modal-content table {
        width: 100%;
    }

    .modal-content th,
    .modal-content td {
        padding: 16px;
    }

    /* 스크롤 가능한 컨테이너 스타일 */
    .table-container {
        max-height: 300px;
        /* 원하는 높이로 조정 */
        overflow-y: auto;
        /* 세로 스크롤 활성화 */
    }

    /* 버튼 스타일 */
    .modal-button {
        background-color: #007bff;
        color: #fff;
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
    }

    .modal-button:hover {
        background-color: #0056b3;
    }

    #datatable-container {
        max-height: 1000px;
        /* Adjust the maximum height as needed */
        overflow-y: auto;
        /* Add vertical scrollbars if the content exceeds the container height */
    }

    #datatable {
        width: 100%;
        /* Other table styles */
    }

    .notification {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background-color: #f0f0f0;
        padding: 10px;
        border-radius: 4px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        z-index: 9999;
        display: flex;
        align-items: center;
    }

    .notification img {
        width: 100px;
        height: 50px;
        margin-right: 10px;
    }

    .notification-message {
        font-size: 16px;
        color: #333;
    }

    #customer-select {
        padding: 8px;
        font-size: 14px;
        border: none;
        background-color: #f2f2f2;
        border-radius: 4px;
        width: 100%;
        box-sizing: border-box;
    }

    #house-select {
        display: block;
        width: 100%;
        padding: 10px;
        font-size: 16px;
        border: 1px solid #ccc;
        border-radius: 4px;
    }

    .custom-file-input {
        background-color: #007bff;
        color: #fff;
        padding: 10px 15px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 12px;
        display: inline-block;
        /* 인라인 요소로 표시 */
        position: relative;
        /* 위치를 상대적으로 설정 */
    }

    .custom-file-label {
        font-size: 16px;
        padding: 5px 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
        display: inline-block;
        /* 인라인 요소로 표시 */
    }

    .fixed-bottom {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        /* 전체 화면 너비로 확장합니다. */
    }

    /* 일반적인 스타일 */
    select {
        width: 100%;
        padding: 8px;
        font-size: 16px;
        border: 1px solid #ccc;
        border-radius: 4px;
        box-sizing: border-box;
    }

    /* 활성화된 상태일 때의 스타일 */
    select:focus {
        outline: none;
        border-color: #4CAF50;
        /* 원하는 색상으로 변경 */
        box-shadow: 0 0 5px rgba(76, 175, 80, 0.5);
        /* 선택한 색상으로 변경 */
    }

    /* 옵션 스타일 */
    select option {
        padding: 8px;
    }

    /* 마우스가 올라간 상태일 때의 옵션 스타일 */
    select option:hover {
        background-color: #f2f2f2;
        /* 원하는 배경색으로 변경 */
    }
</style>

<body>



    <div class="main_header">
        <a>슬리팅</a>

    </div>
    <div id="loadingOverlay">
        <img src="/img/테크온로고.PNG" alt="로딩 이미지" class="loadingImage">

    </div>
    <!-- <div class="form-group">
        <table style="width:30%;">
            <tr>
                <td style="width: 100px; background-color: whitesmoke;">슬리팅 날짜</td>
                <td style="width: 100px;"> <input type="date" id="datepicker2"
                        style="width:100%; display: inline-block; font-size: 15px; font-weight:bold; padding: 6px 12px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box;">
                </td>
                <td style="width: 100px;"> <input type="date" id="datepicker3"
                        style="width:100%; display: inline-block; font-size: 15px; font-weight:bold; padding: 6px 12px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box;">
                </td>
                <td style="width: 50px;"> <input type="button" value="조회" onclick="POsearching()"
                        style="width:100%; cursor: pointer; display: inline-block; font-size: 15px; font-weight:bold; padding: 6px 12px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; background-color: navy; color: white;">
                </td>
            </tr>
        </table>

    </div> -->


    <div class="form-group">
        <table style="width:50%;">
            <tr>
                <td style="width: 100px; background-color: whitesmoke;">슬리팅 날짜</td>
                <td style="width: 100px;"> <input type="date" id="datepicker2"
                        style="width:100%; display: inline-block; font-size: 15px; font-weight:bold; padding: 6px 12px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box;">
                </td>
                <td style="width: 100px;"> <input type="date" id="datepicker3"
                        style="width:100%; display: inline-block; font-size: 15px; font-weight:bold; padding: 6px 12px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box;">
                </td>
                <td style="width: 50px;"> <input type="button" value="조회" onclick="POsearching()"
                        style="width:100%; cursor: pointer; display: inline-block; font-size: 15px; font-weight:bold; padding: 6px 12px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; background-color: navy; color: white;">
                </td>
                <td style="width: 50px;"> <input type="button" value="슬리팅 등록" onclick="New()"
                        style="width:100%; cursor: pointer; display: inline-block; font-size: 15px; font-weight:bold; padding: 6px 12px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; background-color: rgb(71, 22, 55); color: white;">
                </td>
                <td style="width: 50px;"> <input type="button" value="작업지시등록" onclick="New1()"
                        style="width:100%; cursor: pointer; display: inline-block; font-size: 15px; font-weight:bold; padding: 6px 12px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; background-color: black; color: white;">
                </td>

            </tr>
        </table>

    </div>

    <!-- 등록창 -->
    <div id="popupOverlay" style="display: none;">
        <div id="popupContent" style="width: 70%; height: auto;">
            <div class="form-group">
                <table style="width: 100%;">
                    <tr>
                        <td colspan="4" style="width: 200px; background-color: black; color: white;">슬리팅 정보</td>
                    </tr>




                </table>


            </div>
            <div>
                <button style="float: right;" id="popupCloseBtn-search">제품조회</button>
            </div>

            <br>

            <div style="width:100%; max-height: 600px; overflow-y: scroll;">
                <table class="styled-table" id="Podatatable">
                    <thead>
                        <tr>
                            <th>자재명</th>
                            <th>LOTNO</th>
                            <th>자재폭(mm)</th>
                            <th>제조일자</th>
                            <th>만료일자</th>
                            <th>수량(M)</th>
                            <th>수입검사</th>
                            <th style="width:100px;"></th>
                            <th style="width:100px;"></th>
                        </tr>
                    </thead>
                    <tbody id="POdatatbody">
                    </tbody>
                    <tfoot>
                        <tr>
                            <td style="border:1px solid silver; background-color:whitesmoke;" colspan="7">합계</td>
                            <td style="border:1px solid silver; text-align:right;"><strong>0
                                </strong></td>
                            <td style="border:1px solid silver; text-align:right;"><strong>0
                                </strong></td>
                            <td style="border:1px solid silver; background-color:whitesmoke; " colspan="2"></td>
                        </tr>
                    </tfoot>
                </table>
            </div>


            <button id="popupCloseBtn-save-close">취소</button>
            <button id="popupCloseBtn-save" onclick="Datasave()">저장</button>
        </div>
    </div>


    <div id="popupOverlaycontent" style="display: none;">
        <div id="popupContentcontent" style="width: 70%; height: auto;">
            <div class="form-group">
                <table style="width: 85%;">
                    <tr>
                        <td colspan="4" style="width: 200px; background-color: black; color: white;">영업수주등록</td>
                    </tr>
                    <tr>
                        <td style="width: 25%; background-color: whitesmoke;">고객사</td>
                        <td><input type="text" id="customer-content" class="data" autocomplete="off" readonly
                                style="width:100%; border:1px solid silver;"></td>
                        <td style="width: 25%; background-color: whitesmoke;">납기일자</td>
                        <td style="width: 25%; background-color: whitesmoke;">

                            <input type="date" id="datepicker-content"
                                style="width:100%; display: inline-block; font-size: 15px; font-weight:bold; padding: 6px 12px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box;">
                        </td>
                    </tr>



                </table>


            </div>
            <div>
                <button style="float: right;" id="popupCloseBtn-search">품목조회</button>
            </div>

            <br>

            <div style="width:100%; max-height: 600px; overflow-y: scroll;">
                <table class="styled-table" id="POdatatable-content">
                    <thead>
                        <tr>
                            <th>품목코드</th>
                            <th>BOMNO</th>
                            <th>모델명</th>
                            <th>품목명</th>
                            <th>고객사</th>
                            <th>원가(원)</th>
                            <th>단가(원)</th>
                            <th>PO수량(개)</th>
                            <th>판매금액(원)</th>
                            <th style="width:100px;"></th>
                            <th style="width:100px;"></th>
                        </tr>
                    </thead>
                    <tbody id="POtable-tbody">
                    </tbody>
                    <tfoot>
                        <tr>
                            <td style="border:1px solid silver; background-color:whitesmoke;" colspan="7">합계</td>
                            <td style="border:1px solid silver; text-align:right;"><strong>0
                                </strong></td>
                            <td style="border:1px solid silver; text-align:right;"><strong>0
                                </strong></td>
                            <td style="border:1px solid silver; background-color:whitesmoke; " colspan="2"></td>
                        </tr>
                    </tfoot>
                </table>
            </div>


            <button id="popupCloseBtn-content-close">취소</button>
            <button id="popupCloseBtn-content" onclick="Datasave()">수정</button>
        </div>
    </div>




    <div id="datatable-container">
        <table class="styled-table" id="materialdatatable">

            <thead>
                <tr>
                    <th colspan="2" style="border:1px solid silver; font-size: 18px;"></th>
                    <th colspan="6" style="border:1px solid silver; font-size: 18px;">슬리팅자재입고</th>
                    <th colspan="5" style="border:1px solid silver; font-size: 18px;">작업지시내용</th>
                    <th colspan="5" style="border:1px solid silver; font-size: 18px;">슬리팅실적</th>
                    <th colspan="1" style="border:1px solid silver;  font-size: 18px;"></th>
                </tr>
                <tr>
                    <th style="border:1px solid silver;">작업지시날짜</th>
                    <th style="border:1px solid silver;">구분</th>
                    <th style="border:1px solid silver;">자재명</th>
                    <th style="border:1px solid silver;">구분</th>
                    <th style="border:1px solid silver;">규격폭(mm)</th>
                    <th style="border:1px solid silver;">M</th>
                    <th style="border:1px solid silver;">롤수량</th>
                    <th style="border:1px solid silver;">입고수량(M)</th>
                    <th style="border:1px solid silver;">규격폭(mm)</th>
                    <th style="border:1px solid silver;">M</th>
                    <th style="border:1px solid silver;">롤수량</th>
                    <th style="border:1px solid silver;">재단수량(M)</th>
                    <th style="border:1px solid silver;">폐기여부</th>
                    <th style="border:1px solid silver;">규격폭(mm)</th>
                    <th style="border:1px solid silver;">M</th>
                    <th style="border:1px solid silver;">롤수량</th>
                    <th style="border:1px solid silver;">재단수량(M)</th>
                    <th style="border:1px solid silver;">폐기여부</th>
                    <th style="border:1px solid silver; width:100px;">실적입력</th>
                </tr>
            </thead>



            <tbody id="materialinputtbody">
            </tbody>
        </table>
    </div>
    <!-- 품목조회창 -->
    <div id="popupOverlay3" style="display: none;">
        <div id="popupContent3" style="width: 40%; height: auto;">

            <div style="width:100%; max-height: 600px; overflow-y: scroll;">
                <table class="styled-table" id="datatable">

                    <thead>
                        <tr>
                            <td colspan="9" style="width: 200px; background-color: black; color: white;">자재 재고 정보
                            </td>
                        </tr>
                        <tr>
                            <td style="width: 300px; background-color: whitesmoke; color: black;">슬리팅 자재명</td>
                            <td colspan="2"> <input type="text" id="myInput1" onkeydown="handleKeyPress(event)"
                                    class="data" autocomplete="off" style="width:auto; border:1px solid silver;"></td>

                        </tr>
                        <tr>
                            <td style="width: 300px; background-color: whitesmoke; color: black;">슬리팅 자재폭(mm)</td>
                            <td colspan="2"> <input type="text" id="searchmaterialwidth"
                                    onkeydown="handleKeyPress(event)" class="data" autocomplete="off"
                                    style="width:auto; border:1px solid silver;"></td>

                        </tr>
                        <tr>
                            <td style="width: 300px; background-color: whitesmoke; color: black;">필요 소요량(M)</td>
                            <td colspan="2"> <input type="text" id="myInput2" class="data" autocomplete="off"
                                    style="width:auto; border:1px solid silver;"></td>

                        </tr>
                        <tr>
                            <th>원자재명</th>
                            <th>분류</th>
                            <th>자재폭(mm)</th>
                            <th>수량(M)</th>
                            <th>롤</th>
                            <th>총입고수량(M)</th>

                            <th style="background-color: silver; color:black;" style="width:100px;"></th>
                        </tr>
                    </thead>
                    <tbody id="Datatbody">
                    </tbody>
                </table>
            </div>
            <button id="popupCloseBtn-search-close">닫기</button>

        </div>

    </div>



    <div id="popupOverlay2" style="display: none;">
        <div id="popupContent2" style="width: 100%; height: auto;">

            <div style="width:100%; max-height: 60%; overflow-y: scroll;">
                <table class="styled-table" id="datatablesliting">

                    <thead>
                        <tr>
                            <td colspan="2" class="popup_title">생산LOT :</td>
                            <td colspan="10"><input type="text" id="slitingdate1" class="data" autocomplete="off"
                                    style="width:100%; border:1px solid silver;" placeholder="생산LOT 검색.."></td>
                        </tr>

                        <tr>
                            <th style="font-size:14px;">생산계획날짜</th>
                            <th style="font-size:14px;">LOTNO.</th>
                            <th style="font-size:14px;">BOMNO.</th>
                            <th style="font-size:14px;">소요자재명</th>
                            <th style="font-size:14px;">자재폭</th>
                            <th style="font-size:14px;">소요량</th>
                            <th style="font-size:14px;">현재고</th>
                            <th style="font-size:14px;">작업지시</th>
                            <th style="font-size:14px;">필요재고</th>
                            <th style="font-size:14px;">상태</th>

                            <th style="width:100px;"></th>
                        </tr>
                    </thead>
                    <tbody id="Datatbody11">
                    </tbody>
                </table>
                <table class="styled-table" id="datatablesliting1">

                    <thead>
                        <tr>
                            <td colspan="2" class="popup_title">자재재고상세</td>
                            <td colspan="1"><button onclick="habji()" class="habjibtn">합지슬리팅</button></td>

                        </tr>

                        <tr>
                            <th></th>
                            <th>자재명</th>
                            <th>자재LOT</th>
                            <th>규격폭(mm)</th>
                            <th>롤(roll)</th>
                            <th>M</th>
                            <th><button class="sliting">슬리팅등록</button></th>


                            <!-- <th style="background-color: silver; color:black;" style="width:100px;"></th> -->
                        </tr>
                    </thead>
                    <tbody id="Datatbody111">
                    </tbody>
                </table>

            </div>
            <button id="popupCloseBtn-delete-close">닫기</button>

        </div>

    </div>



    <!-- 수정창 -->
    <!-- <div id="popupOverlay1" style="display: none;">
        <div id="popupContent1" style="width: 700px; height: auto;">
            <div class="form-group">
                <table style="width:100%;">
                    <tr>
                        <td style="background-color: black; color: white;">슬리팅 작업지시</td>
                        <td style="visibility: hidden;"><input type="text" id="id-edit" class="data" autocomplete="off"
                                style="width:100%; border:1px solid silver; "></td>
                    </tr>
                    <tr>
                        <td style="width: 100px; background-color: whitesmoke;">구분</td>
                        <td style="width: 100px;">
                            <select id="part-select" class="select-box">
                                <option></option>
                                <option>슬리팅</option>
                                <option>컷팅</option>
                            </select>
                        </td>

                    <tr>
                        <td style="width: 200px">자재명</td>
                        <td><input type="text" id="materialname" class="data" autocomplete="off" readonly
                                style="width:auto; border:1px solid silver;"></td>
                    </tr>
                    <tr>
                        <td style="width: 200px">분류</td>
                        <td><input type="text" id="classification" class="data" autocomplete="off" readonly
                                style="width:auto; border:1px solid silver;"></td>
                    </tr>



                    <tr>
                        <td style="width: 200px; background-color: whitesmoke; ">자재폭(mm)</td>
                        <td><input type="text" id="materialwidth" class="data" autocomplete="off"
                                style="width:auto; border:1px solid silver;"></td>
                    </tr>
                    <tr>
                        <td style="width: 200px; background-color: whitesmoke; ">롤(roll)</td>
                        <td><input type="text" id="roll" class="data" autocomplete="off"
                                style="width:auto; border:1px solid silver;"></td>
                    </tr>
                    <tr>
                        <td style="width: 200px; background-color: whitesmoke; ">M</td>
                        <td><input type="text" id="quantity" class="data" autocomplete="off"
                                style="width:auto; border:1px solid silver;"></td>
                    </tr>
                    <tr>
                        <td style="width: 200px; background-color: whitesmoke; ">합계수량(M)</td>
                        <td><input type="text" id="totalquantity" class="data" autocomplete="off"
                                style="width:auto; border:1px solid silver;"></td>
                    </tr>
                    <tr style="display: none;">
                        <td style="width: 200px; background-color: whitesmoke; ">자재삭제</td>
                        <td><input type="text" id="materialname-delete" class="data" autocomplete="off"
                                style="width:auto; border:1px solid silver; "></td>
                    </tr>
                    <tr style="display: none;">
                        <td style="width: 200px; background-color: whitesmoke; ">분류삭제</td>
                        <td><input type="text" id="classification-delete" class="data" autocomplete="off"
                                style="width:100%; border:1px solid silver; "></td>
                    </tr>
                    <tr style="display: none;">
                        <td style="width: 200px; background-color: whitesmoke; ">로트삭제</td>
                        <td><input type="text" id="lotno-delete" class="data" autocomplete="off"
                                style="width:100%; border:1px solid silver; "></td>
                    </tr>
                    <tr style="display: none;">
                        <td style="width: 200px; background-color: whitesmoke; ">자재폭삭제</td>
                        <td><input type="text" id="materialwidth-delete" class="data" autocomplete="off"
                                style="width:100%; border:1px solid silver; "></td>
                    </tr>

                    <tr style="display: none;">
                        <td style="width: 200px; background-color: whitesmoke; ">수량삭제</td>
                        <td><input type="text" id="quantity-delete" class="data" autocomplete="off"
                                style="width:100%; border:1px solid silver; "></td>
                    </tr>
                    <tr style="display: none;">
                        <td style="width: 200px; background-color: whitesmoke; ">단가삭제</td>
                        <td><input type="text" id="sqmprice-delete" class="data" autocomplete="off"
                                style="width:100%; border:1px solid silver; "></td>
                    </tr>
                    <tr style="display: none;">

                        <td style="width: 200px; background-color: whitesmoke; ">채번삭제</td>
                        <td><input type="text" id="codenumber-delete" class="data" autocomplete="off"
                                style="width:100%; border:1px solid silver; "></td>
                    </tr>
                    <tr style="display: none;">

                        <td style="width: 200px; background-color: whitesmoke; ">제조삭제</td>
                        <td><input type="text" id="manu-delete" class="data" autocomplete="off"
                                style="width:100%; border:1px solid silver; "></td>
                    </tr>
                    <tr style="display: none;">
                        <td style="width: 200px; background-color: whitesmoke; ">만료삭제</td>
                        <td><input type="text" id="exp-delete" class="data" autocomplete="off"
                                style="width:100%; border:1px solid silver; "></td>
                    </tr>
                    <tr style="display: none;">
                        <td style="width: 200px; background-color: whitesmoke; ">id삭제</td>
                        <td><input type="text" id="materialid-delete" class="data" autocomplete="off"
                                style="width:100%; border:1px solid silver; "></td>
                    </tr>
                    <table class="slitting-table" id="slitingtable">
                        <thead>
                            <tr>
                                <th>자재폭(mm)</th>
                                <th>M</th>
                                <th>롤수량(M)</th>
                                <th>재단수량(M)</th>
                                <th style="width:20%;">폐기여부</th>
                                <th>
                                    <button class="add-button" onclick="add1()">추가</button>
                                </th>
                            </tr>
                        </thead>
                        <tbody id="datatable1tbody">
                            <tr>
                                <td><input type="text" class="slitting-input" id="finallotno1" autocomplete="off"></td>
                                <td><input type="text" class="slitting-input" id="finalmwidth1" autocomplete="off"></td>
                                <td><input type="text" class="slitting-input" id="finalroll1" onkeydown="sum(event)"
                                        autocomplete="off"></td>
                                <td><input type="text" class="slitting-input" id="finalsumquantity1" autocomplete="off">
                                </td>
                                <td id="finaltrash1"></td>
                                <td><a class="delete-link" id="datalotdelete">삭제</a></td>
                            </tr>
                        </tbody>
                    </table>

                </table>
            </div>
            <button id="popupCloseBtn-edit-close">취소</button>
            <button id="popupCloseBtn-edit" onclick="Dataedit()">등록</button>
        </div>
    </div> -->


    <!-- 수정창 -->
    <div id="popupOverlay12" style="display: none;">
        <div id="popupContent12" style="width: 700px; height: auto;">
            <div class="form-group">
                <table style="width:100%;">
                    <tr>
                        <td style="background-color: black; color: white;">슬리팅 실적입력</td>
                        <td><input type="text" id="id-edit2" class="data" autocomplete="off"
                                style="width:100%; border:1px solid silver; "></td>
                    </tr>
                    <tr>
                        <td style="width: 100px; background-color: whitesmoke;">구분</td>
                        <td style="width: 100px;">
                            <select id="part-select" class="select-box">
                                <option></option>
                                <option>슬리팅</option>
                                <option>컷팅</option>
                            </select>
                        </td>

                    <tr>
                        <td style="width: 200px">자재명</td>
                        <td><input type="text" id="materialname" class="data" autocomplete="off" readonly
                                style="width:auto; border:1px solid silver;"></td>
                    </tr>
                    <tr>
                        <td style="width: 200px">분류</td>
                        <td><input type="text" id="classification" class="data" autocomplete="off" readonly
                                style="width:auto; border:1px solid silver;"></td>
                    </tr>



                    <tr>
                        <td style="width: 200px; background-color: whitesmoke; ">자재폭(mm)</td>
                        <td><input type="text" id="materialwidth" class="data" autocomplete="off"
                                style="width:auto; border:1px solid silver;"></td>
                    </tr>
                    <tr>
                        <td style="width: 200px; background-color: whitesmoke; ">롤(roll)</td>
                        <td><input type="text" id="roll" class="data" autocomplete="off"
                                style="width:auto; border:1px solid silver;"></td>
                    </tr>
                    <tr>
                        <td style="width: 200px; background-color: whitesmoke; ">M</td>
                        <td><input type="text" id="quantity" class="data" autocomplete="off"
                                style="width:auto; border:1px solid silver;"></td>
                    </tr>
                    <tr>
                        <td style="width: 200px; background-color: whitesmoke; ">합계수량(M)</td>
                        <td><input type="text" id="totalquantity" class="data" autocomplete="off"
                                style="width:auto; border:1px solid silver;"></td>
                    </tr>
                    <tr style="display: none;">
                        <td style="width: 200px; background-color: whitesmoke; ">자재삭제</td>
                        <td><input type="text" id="materialname-delete" class="data" autocomplete="off"
                                style="width:auto; border:1px solid silver; "></td>
                    </tr>
                    <tr style="display: none;">
                        <td style="width: 200px; background-color: whitesmoke; ">분류삭제</td>
                        <td><input type="text" id="classification-delete" class="data" autocomplete="off"
                                style="width:100%; border:1px solid silver; "></td>
                    </tr>
                    <tr style="display: none;">
                        <td style="width: 200px; background-color: whitesmoke; ">로트삭제</td>
                        <td><input type="text" id="lotno-delete" class="data" autocomplete="off"
                                style="width:100%; border:1px solid silver; "></td>
                    </tr>
                    <tr style="display: none;">
                        <td style="width: 200px; background-color: whitesmoke; ">자재폭삭제</td>
                        <td><input type="text" id="materialwidth-delete" class="data" autocomplete="off"
                                style="width:100%; border:1px solid silver; "></td>
                    </tr>

                    <tr style="display: none;">
                        <td style="width: 200px; background-color: whitesmoke; ">수량삭제</td>
                        <td><input type="text" id="quantity-delete" class="data" autocomplete="off"
                                style="width:100%; border:1px solid silver; "></td>
                    </tr>
                    <tr style="display: none;">
                        <td style="width: 200px; background-color: whitesmoke; ">단가삭제</td>
                        <td><input type="text" id="sqmprice-delete" class="data" autocomplete="off"
                                style="width:100%; border:1px solid silver; "></td>
                    </tr>
                    <tr style="display: none;">

                        <td style="width: 200px; background-color: whitesmoke; ">채번삭제</td>
                        <td><input type="text" id="codenumber-delete" class="data" autocomplete="off"
                                style="width:100%; border:1px solid silver; "></td>
                    </tr>
                    <tr style="display: none;">

                        <td style="width: 200px; background-color: whitesmoke; ">제조삭제</td>
                        <td><input type="text" id="manu-delete" class="data" autocomplete="off"
                                style="width:100%; border:1px solid silver; "></td>
                    </tr>
                    <tr style="display: none;">
                        <td style="width: 200px; background-color: whitesmoke; ">만료삭제</td>
                        <td><input type="text" id="exp-delete" class="data" autocomplete="off"
                                style="width:100%; border:1px solid silver; "></td>
                    </tr>
                    <tr style="display: none;">
                        <td style="width: 200px; background-color: whitesmoke; ">id삭제</td>
                        <td><input type="text" id="materialid-delete" class="data" autocomplete="off"
                                style="width:100%; border:1px solid silver; "></td>
                    </tr>
                    <table class="slitting-table">
                        <thead>
                            <tr>
                                <th>자재폭(mm)</th>
                                <th>M</th>
                                <th>롤수량(M)</th>
                                <th>재단수량(M)</th>
                                <th style="width:20%;">폐기여부</th>
                                <th>
                                    <button class="add-button" onclick="add1()">추가</button>
                                </th>
                            </tr>
                        </thead>
                        <tbody id="datatable1tbody">
                            <tr>
                                <td><input type="text" class="slitting-input" id="lotno1" autocomplete="off"></td>
                                <td><input type="text" class="slitting-input" id="mwidth1" autocomplete="off"></td>
                                <td><input type="text" class="slitting-input" id="roll1" onkeydown="sum(event)"
                                        autocomplete="off"></td>
                                <td><input type="text" class="slitting-input" id="sumquantity1" autocomplete="off"></td>
                                <td id="trash1"></td>
                                <td><a class="delete-link" id="datalotdelete">삭제</a></td>
                            </tr>
                        </tbody>
                    </table>

                </table>
            </div>
            <button id="popupCloseBtn-edit-close">취소</button>
            <button id="popupCloseBtn-edit" onclick="Dataedit()">등록</button>
        </div>
    </div>
    <div id="popupOverlay4" style="display: none;">
        <div id="popupContent" style="width:50%; margin: 0 auto;">
            <div class="form-group" style="display: flex;">
                <!-- 왼쪽 컨테이너 -->
                <div style="width: 50%; padding: 10px;">
                    <table style="width:100%;">
                        <tr>
                            <td class="popup_title">슬리팅 입고</td>
                            <td><input type="text" id="orderno" class="data" autocomplete="off"
                                    style="width:auto; border:1px solid silver; visibility:hidden;"></td>
                        </tr>
                        <tr>
                            <td style="width: 150px;">작업지시날짜</td>
                            <td><input type="text" id="slitingdate" class="data" autocomplete="off"
                                    style="width:auto; border:1px solid silver;"></td>
                        </tr>
                        <tr>
                            <td style="width: 150px;">구분</td>
                            <td><input type="text" id="slt-part" class="data" autocomplete="off"
                                    style="width:auto; border:1px solid silver;"></td>
                        </tr>
                        <tr>
                            <td style="width: 150px;">자재명</td>
                            <td><input type="text" id="slt-materialname" class="data" autocomplete="off"
                                    style="width:auto; border:1px solid silver;"></td>
                        </tr>
                        <tr>
                            <td style="width: 150px;">자재구분</td>
                            <td><input type="text" id="slt-classification" class="data" autocomplete="off"
                                    style="width:auto; border:1px solid silver;"></td>
                        </tr>
                        <tr>
                            <td style="width: 150px;">규격폭(mm)</td>
                            <td><input type="text" id="slt-materialwidth" class="data" autocomplete="off"
                                    style="width:auto; border:1px solid silver;"></td>
                        </tr>
                        <tr>
                            <td style="width: 150px;">수량(M)</td>
                            <td><input type="text" id="slt-m" class="data" autocomplete="off"
                                    style="width:auto; border:1px solid silver;"></td>
                        </tr>
                        <tr>
                            <td style="width: 150px;">롤(roll)</td>
                            <td><input type="text" id="slt-roll" class="data" autocomplete="off"
                                    style="width:auto; border:1px solid silver;"></td>
                        </tr>
                        <tr>
                            <td style="width: 150px;">입고수량(M)</td>
                            <td><input type="text" id="slt-total" class="data" autocomplete="off"
                                    style="width:auto; border:1px solid silver;"></td>
                        </tr>
                        <tr>
                            <td style="width: 150px;"></td>
                            <td><input type="text" id="id-edit1" class="data" autocomplete="off"
                                    style="width:auto; border:1px solid silver;"></td>
                        </tr>
                    </table>
                </div>
                <!-- 오른쪽 컨테이너 -->
                <div style="width: 50%; padding: 10px;">
                    <table style="width:100%;" class="styled-table">
                        <thead>
                            <tr>
                                <td colspan="4" class="popup_title">슬리팅 작업지시</td>
                            </tr>
                            <tr>
                                <th>규격폭</th>
                                <th>수량(M)</th>
                                <th>롤(roll)</th>
                                <th>출고수량(M)</th>
                            </tr>
                        </thead>

                        <tbody id="slitingafter">
                        </tbody>


                    </table>
                </div>
            </div>
            <table class="styled-table" id="slttable">
                <thead>
                    <tr>
                        <td colspan="5" class="popup_title">슬리팅 실적</td>
                    </tr>
                    <tr>
                        <th>자재폭</th>
                        <th>수량(M)</th>
                        <th>롤(roll)</th>
                        <th>재단수량(M)</th>
                        <th style="width:100px;">
                            <button
                                style="cursor:pointer; width: 100%; height: 100%; font-weight: bold; background-color: navy; color: white; border: none; border-radius: 4px; padding: 8px;"
                                onclick="add()">추가</button>
                        </th>
                    </tr>
                </thead>

                <tbody id="datatable1tbody1">
                    <tr>
                        <td style="border:2px solid whitesmoke;"><input type="text" id="finalmaterialwidth1"
                                autocomplete="off"
                                style="width: 100%; height: 100%; text-align: right; font-size: 24px;"></td>
                        <td style="border:2px solid whitesmoke;"><input type="text" id="finalm1" autocomplete="off"
                                style="width: 100%; height: 100%; text-align: right; font-size: 24px;"></td>
                        <td style="border:2px solid whitesmoke;"><input type="text" id="finalroll1" autocomplete="off"
                                style="width: 100%; height: 100%; text-align: right; font-size: 24px;"></td>
                        <td style="border:2px solid whitesmoke;"><input type="text" id="finalt1" autocomplete="off"
                                style="width: 100%; height: 100%; text-align: right; font-size: 24px;"></td>
                        <td style="border:2px solid whitesmoke;"></td>

                    </tr>

                </tbody>
            </table>
            <!-- 버튼 영역 -->
            <div style="text-align: center; padding: 10px;">
                <button id="popupCloseBtn-POedit-close">취소</button>
                <button id="popupCloseBtn-POedit" onclick="Dataedit()">실적입력</button>
            </div>
        </div>
    </div>
    <div id="popupOverlay5" style="display: none;">
        <div id="popupContent" style="width:40%; margin: 0 auto;">
            <div class="form-group" style="display: flex;">
                <!-- 왼쪽 컨테이너 -->
                <div style="width: 100%; padding: 10px;">
                    <table style="width:100%;">
                        <tr>
                            <td colspan="2" class="popup_title">슬리팅 작업지시</td>
                        </tr>
                        <tr>
                            <td style="width: 150px;">작업지시날짜</td>
                            <td><input type="date" id="slitingdate-save" class="data" autocomplete="off"
                                    style="width:auto; border:1px solid silver;"></td>
                        </tr>
                        <tr>
                            <td style="width: 150px;">구분</td>
                            <td><input type="text" id="slt-part-save" class="data" autocomplete="off"
                                    style="width:auto; border:1px solid silver;"></td>
                        </tr>
                        <tr>
                            <td style="width: 150px;">수량합계</td>
                            <td><input type="text" id="slt-quantity-save" class="data" autocomplete="off"
                                    style="width:auto; border:1px solid silver;"></td>
                        </tr>
                        <table class="styled-table" id="selecttable" style="width: 100%;">
                            <thead>
                                <tr>
                                    <td colspan="6" class="popup_title">슬리팅 자재선택</td>
                                </tr>
                                <tr>
                                    <th><input type="checkbox"></th>
                                    <th>자재명</th>
                                    <th>LOT NO.</th>
                                    <th>자재폭(mm)</th>
                                    <th>롤(roll)</th>
                                    <th>수량(M)</th>

                                </tr>
                            </thead>

                            <tbody id="selectmaterialinput">


                            </tbody>
                        </table>
                    </table>
                </div>

            </div>
            <table class="styled-table" id="slttable1" style="width: 100%;">
                <thead>
                    <tr>
                        <td colspan="6" class="popup_title">슬리팅 작업지시</td>
                    </tr>
                    <tr>
                        <th style="width:200px;">LOTNO.</th>
                        <th style="width:auto;">자재폭</th>
                        <th style="width:auto;">수량(M)</th>
                        <th style="width:auto;">롤(roll)</th>
                        <th style="width:auto;">재단수량(M)</th>
                        <th style="width:100px;">
                            <button
                                style="cursor:pointer; width: 100%; height: 100%; font-weight: bold; background-color: navy; color: white; border: none; border-radius: 4px; padding: 8px;"
                                onclick="add3()">추가</button>
                        </th>
                    </tr>
                </thead>

                <tbody id="datatable1tbody12">
                    <tr>
                        <td style="border:2px solid whitesmoke;">
                            <select id="afterlotno1">

                            </select>
                        </td>
                        <td style="border:2px solid whitesmoke;"><input type="text" id="aftermaterialwidth1"
                                style="width: 100%; height: 100%; text-align: right; font-size: 24px;"
                                autocomplete="off"></td>
                        <td style="border:2px solid whitesmoke;"><input type="text" id="afterm1"
                                style="width: 100%; height: 100%; text-align: right; font-size: 24px;"
                                autocomplete="off"></td>
                        <td style="border:2px solid whitesmoke;"><input type="text" id="afterroll1"
                                onkeydown="handleKeyPress1(event)"
                                style="width: 100%; height: 100%; text-align: right; font-size: 24px;"
                                autocomplete="off"></td>
                        <td style="border:2px solid whitesmoke;"><input type="text" id="aftert1"
                                style="width: 100%; height: 100%; text-align: right; font-size: 24px;"
                                autocomplete="off"></td>
                        <td style="border:2px solid whitesmoke;"></td>

                    </tr>

                </tbody>
            </table>
            <!-- 버튼 영역 -->
            <div style="text-align: center; padding: 10px;">
                <button id="popupCloseBtn-slt-close">취소</button>
                <button id="popupCloseBtn-slt" onclick="Dataedit2()">저장</button>
            </div>
        </div>
    </div>
    <div id="popupOverlay6" style="display: none;">
        <div id="popupContent" style="width:40%; margin: 0 auto;">
            <div class="form-group" style="display: flex;">
                <!-- 왼쪽 컨테이너 -->
                <div style="width: 50%; padding: 10px; float: left;">
                    <table style="width:100%;">
                        <tr>
                            <td colspan="2" class="popup_title">합지 슬리팅 작업지시</td>
                        </tr>
                        <tr>
                            <td style="width: 150px;">작업지시날짜</td>
                            <td><input type="date" id="habji-slitingdate-save" class="data" autocomplete="off"
                                    style="width:auto; border:1px solid silver;"></td>
                        </tr>
                        <tr>
                            <td style="width: 150px;">구분</td>
                            <td><input type="text" id="habji-part-save" class="data" autocomplete="off"
                                    style="width:auto; border:1px solid silver;"></td>
                        </tr>
                        <tr>
                            <td style="width: 150px;">자재명</td>
                            <td><input type="text" id="habji-materialname-save" class="data" autocomplete="off"
                                    style="width:auto; border:1px solid silver;"></td>
                        </tr>
                        <tr>
                            <td style="width: 150px;">자재구분</td>
                            <td><input type="text" id="habji-classification-save" class="data" autocomplete="off"
                                    style="width:auto; border:1px solid silver;"></td>
                        </tr>
                        <tr>
                            <td style="width: 150px;">규격폭(mm)</td>
                            <td><input type="text" id="habji-materialwidth-save" class="data" autocomplete="off"
                                    style="width:auto; border:1px solid silver;"></td>
                        </tr>
                        <tr>
                            <td style="width: 150px;">수량(M)</td>
                            <td><input type="text" id="habji-m-save" class="data" autocomplete="off"
                                    style="width:auto; border:1px solid silver;"></td>
                        </tr>
                        <tr>
                            <td style="width: 150px;">롤(roll)</td>
                            <td><input type="text" id="habji-roll-save" class="data" autocomplete="off"
                                    style="width:auto; border:1px solid silver;"></td>
                        </tr>
                        <tr>
                            <td style="width: 150px;">입고수량(M)</td>
                            <td><input type="text" id="habji-total-save" class="data" autocomplete="off"
                                    style="width:auto; border:1px solid silver;"></td>
                        </tr>
                    </table>
                </div>
                <div style="width: 50%; padding: 10px; float: right;">
                    <table style="width:100%;">
                        <tr>
                            <td colspan="2" class="popup_title"></td>
                        </tr>
                        <tr>
                            <td style="width: 150px;"></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td style="width: 150px;"></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td style="width: 150px;">자재명</td>
                            <td><input type="text" id="habji1-materialname-save" class="data" autocomplete="off"
                                    style="width:auto; border:1px solid silver;"></td>
                        </tr>
                        <tr>
                            <td style="width: 150px;">자재구분</td>
                            <td><input type="text" id="habji1-classification-save" class="data" autocomplete="off"
                                    style="width:auto; border:1px solid silver;"></td>
                        </tr>
                        <tr>
                            <td style="width: 150px;">규격폭(mm)</td>
                            <td><input type="text" id="habji1-materialwidth-save" class="data" autocomplete="off"
                                    style="width:auto; border:1px solid silver;"></td>
                        </tr>
                        <tr>
                            <td style="width: 150px;">수량(M)</td>
                            <td><input type="text" id="habji1-m-save" class="data" autocomplete="off"
                                    style="width:auto; border:1px solid silver;"></td>
                        </tr>
                        <tr>
                            <td style="width: 150px;">롤(roll)</td>
                            <td><input type="text" id="habji1-roll-save" class="data" autocomplete="off"
                                    style="width:auto; border:1px solid silver;"></td>
                        </tr>
                        <tr>
                            <td style="width: 150px;">입고수량(M)</td>
                            <td><input type="text" id="habji1-total-save" class="data" autocomplete="off"
                                    style="width:auto; border:1px solid silver;"></td>
                        </tr>
                    </table>
                </div>

            </div>

            <table class="styled-table" id="slttable2" style="width: 100%;">
                <thead>
                    <tr>
                        <td colspan="5" class="popup_title">합지 슬리팅 작업지시</td>
                    </tr>
                    <tr>
                        <th>자재폭</th>
                        <th>수량(M)</th>
                        <th>롤(roll)</th>
                        <th>재단수량(M)</th>
                        <th style="width:100px;">
                            <button
                                style="cursor:pointer; width: 100%; height: 100%; font-weight: bold; background-color: navy; color: white; border: none; border-radius: 4px; padding: 8px;"
                                onclick="add4()">추가</button>
                        </th>
                    </tr>
                </thead>

                <tbody id="datatable1tbody123">
                    <tr>
                        <td style="border:2px solid whitesmoke;"><input type="text" id="habji-aftermaterialwidth1"
                                style="width: 100%; height: 100%; text-align: right; font-size: 24px;"
                                autocomplete="off"></td>
                        <td style="border:2px solid whitesmoke;"><input type="text" id="habji-afterm1"
                                style="width: 100%; height: 100%; text-align: right; font-size: 24px;"
                                autocomplete="off"></td>
                        <td style="border:2px solid whitesmoke;"><input type="text" id="habji-afterroll1"
                                style="width: 100%; height: 100%; text-align: right; font-size: 24px;"
                                autocomplete="off"></td>
                        <td style="border:2px solid whitesmoke;"><input type="text" id="habji-aftert1"
                                style="width: 100%; height: 100%; text-align: right; font-size: 24px;"
                                autocomplete="off"></td>
                        <td style="border:2px solid whitesmoke;"></td>

                    </tr>

                </tbody>
            </table>
            <!-- 버튼 영역 -->
            <div style="text-align: center; padding: 10px;">
                <button id="popupCloseBtn-habji-close">취소</button>
                <button id="popupCloseBtn-habji" onclick="Dataedit3()">실적입력</button>
            </div>
        </div>
    </div>






    <script>
        var server = '';

        if (window.location.hostname == 'localhost') {
            server = 'http://localhost:8080';
        } else {
            server = 'http://techonmes.co.kr';
        }
        $(document).ready(function () {
            showLoading()
            settingDate()

            $('#count-edit').on('input', function () {
                var value = $(this).val().replace(/[^0-9]/g, ''); // 숫자 이외의 문자 제거
                if (value === '') {
                    $(this).val('');
                } else {
                    $(this).val(parseInt(value, 10).toLocaleString());
                }
            });


            load()

            $.ajax({
                type: 'POST',
                url: server + '/api/materialrealstock',
                dataType: 'json',
                success: function (data) {
                    for (var i = 0; i < data.length; i++) {


                        $('#datatable').append(
                            '<tr>' +
                            '<td>' + data[i].materialname + '</td>' +
                            '<td>' + data[i].classification + '</td>' +
                            '<td>' + data[i].lotno + '</td>' +
                            '<td>' + data[i].materialwidth + '</td>' +
                            '<td>' + data[i].totalquantity + '</td>' +
                            '<td><a class="data-edit" style="cursor:pointer; color:navy;">추가</a></td>' +


                            '</tr>'

                        );

                    }
                }
            });






            $('#datatable').on('click', '.data-edit', function () {
                var str = "";
                var tdArr = new Array();// 배열 선언            
                var checkBtn = $(this);

                var tr = checkBtn.parent().parent();
                var td = tr.children();

                var materialname = td.eq(0).text();
                var classification = td.eq(1).text();
                var materialwidth = td.eq(2).text();
                var roll = td.eq(4).text();
                var quantity = td.eq(3).text();
                var totalquantity = td.eq(5).text();
                var lotno = $('#searchmaterialwidth').val()

                $('#materialname').val(materialname)
                $('#classification').val(classification)
                $('#materialwidth').val(materialwidth)
                $('#quantity').val(quantity)
                $('#totalquantity').val(totalquantity)
                $('#mwidth1').val(quantity)
                $('#lotno1').val(lotno)


                $('#roll').val(roll)

                $('#popupOverlay1').fadeIn();
                $('#roll1').focus()
            });

            $('#materialdatatable').on('click', '.data-edit1', function () {

                var str = "";
                var tdArr = new Array();// 배열 선언            
                var checkBtn = $(this);

                var tr = checkBtn.parent().parent();
                var td = tr.children();

                var slitingdate = td.eq(0).text();
                var part = td.eq(1).text();
                var materialname = td.eq(2).text();
                var classification = td.eq(3).text();
                var materialwidth = td.eq(4).text();
                var m = td.eq(5).text();
                var roll = td.eq(6).text();
                var total = td.eq(7).text();

                var orderno = td.eq(20).text();

                var id = td.eq(19).text();
                $('#id-edit1').val(id);
                $('#slitingdate').val(slitingdate);
                $('#orderno').val(orderno);
                $('#slt-part').val(part);
                $('#slt-materialname').val(materialname);
                $('#slt-classification').val(classification);
                $('#slt-materialwidth').val(materialwidth);
                $('#slt-m').val(m);
                $('#slt-roll').val(roll);
                $('#slt-total').val(total);
                $('#slitingafter').empty()
                $('#slttable tbody').empty()
                $.ajax({
                    type: 'POST',
                    url: server + '/api/slitinginputdata',
                    dataType: 'json',
                    contentType: 'application/json',
                    data: JSON.stringify({
                        orderno: orderno

                    }),
                    success: function (result) {
                        for (var i = 0; i < result.length; i++) {

                            $('#slitingafter').append(
                                '<tr>' +
                                '<td style="border:1px solid silver; text-align:right;">' + result[i].aftermaterialwidth + '</td>' +
                                '<td style="border:1px solid silver; text-align:right;">' + result[i].afterm + '</td>' +
                                '<td style="border:1px solid silver; text-align:right;">' + result[i].afterroll + '</td>' +
                                '<td style="border:1px solid silver; text-align:right;">' + result[i].aftertotal + '</td>' +

                                '</tr>'
                            );
                            var newRow = '<tr>' +
                                '<td style="border:2px solid whitesmoke;"><input type="text" value="' + result[i].aftermaterialwidth + '" id="finalmaterialwidth' + (i + 1) + '" style="width: 100%; height: 100%; text-align: right; font-size: 24px;"  autocomplete="off"></td>' +
                                '<td style="border:2px solid whitesmoke;"><input type="text" value="' + result[i].afterm + '" id="finalm' + (i + 1) + '" style="width: 100%; height: 100%; text-align: right; font-size: 24px;"  autocomplete="off"></td>' +
                                '<td style="border:2px solid whitesmoke;"><input type="text" value="' + result[i].afterroll + '" id="finalroll' + (i + 1) + '" style="width: 100%; height: 100%; text-align: right; font-size: 24px;"  autocomplete="off"></td>' +
                                '<td style="border:2px solid whitesmoke;"><input type="text" value="' + result[i].aftertotal + '" id="finalt' + (i + 1) + '" style="width: 100%; height: 100%; text-align: right; font-size: 24px;"  autocomplete="off"></td>' +
                                '</tr>';

                            // 새로운 행을 테이블에 추가
                            $('#slttable tbody').append(newRow);
                        }




                    }
                });



                $('#popupOverlay4').fadeIn();
            });






            $('#datatable').on('click', '.data-delete', function () {
                var str = "";
                var tdArr = new Array();// 배열 선언            
                var checkBtn = $(this);

                var tr = checkBtn.parent().parent();
                var td = tr.children();


                var id = td.eq(10).text();
                $('#id-edit').val(id)
                $('#popupOverlay2').fadeIn();
            });


            $('#popupCloseBtn-save-close').click(function () {
                $('#popupOverlay').fadeOut();
            });
            $('#popupCloseBtn-edit-close').click(function () {
                $('#popupOverlay1').fadeOut();
            });
            $('#popupCloseBtn-delete-close').click(function () {
                $('#popupOverlay2').fadeOut();
            });
            $('#popupCloseBtn-search-close').click(function () {
                $('#popupOverlay3').fadeOut();
            });
            $('#popupCloseBtn-search').click(function () {

                $('#popupOverlay3').fadeIn();
                $('#myInput1').focus()
            });
            $('#popupCloseBtn-content-close').click(function () {
                $('#popupOverlaycontent').fadeOut();
            });
            $('#popupCloseBtn-POedit-close').click(function () {
                $('#popupOverlay4').fadeOut();
            });
            $('#popupCloseBtn-slt-close').click(function () {
                $('#popupOverlay5').fadeOut();
            });
            $('#popupCloseBtn-habji-close').click(function () {
                $('#popupOverlay6').fadeOut();
            });


            const selectElement = document.getElementById("house-select");
            if (selectElement) {
                $.ajax({
                    type: 'POST',
                    url: server + '/api/housegroup',
                    dataType: 'json',
                    contentType: 'application/json',
                    success: function (result) {
                        for (let i = 0; i < result.length; i++) {
                            const option = document.createElement("option");
                            option.text = result[i].housename;
                            option.value = result[i].housename;
                            selectElement.add(option);
                        }
                    },
                });
            }

        });



        //오름차순 내림차순
        function sortTable(columnIndex) {
            var table, rows, switching, i, x, y, shouldSwitch, direction, switchcount = 0;
            table = document.getElementById("datatable");
            switching = true;
            direction = "asc"; // 기본 정렬 방향은 오름차순

            while (switching) {
                switching = false;
                rows = table.getElementsByTagName("tr");

                for (i = 1; i < (rows.length - 1); i++) {
                    shouldSwitch = false;
                    x = rows[i].getElementsByTagName("td")[columnIndex];
                    y = rows[i + 1].getElementsByTagName("td")[columnIndex];

                    if (direction == "asc") {
                        if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
                            shouldSwitch = true;
                            break;
                        }
                    } else if (direction == "desc") {
                        if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {
                            shouldSwitch = true;
                            break;
                        }
                    }
                }

                if (shouldSwitch) {
                    rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
                    switching = true;
                    switchcount++;
                } else {
                    if (switchcount == 0 && direction == "asc") {
                        direction = "desc";
                        switching = true;
                    }
                }
            }
        }

        //검색
        function search() {
            const searchInput = document.getElementById('myInput');
            const dataTable = document.getElementById('datatable');
            const tableRows = dataTable.getElementsByTagName('tr');

            searchInput.addEventListener('input', function () {
                const searchValue = this.value.toLowerCase();

                for (let i = 1; i < tableRows.length; i++) {
                    const rowData = tableRows[i].getElementsByTagName('td');

                    let found = false;

                    for (let j = 0; j < rowData.length; j++) {
                        const cellData = rowData[j].textContent.toLowerCase();

                        if (cellData.includes(searchValue)) {
                            found = true;
                            break;
                        }
                    }

                    if (found) {
                        tableRows[i].style.display = '';
                    } else {
                        tableRows[i].style.display = 'none';
                    }

                }
            });
        }
        function showLoading() {
            var loadingOverlay = document.getElementById("loadingOverlay");
            loadingOverlay.style.display = "flex";

            // 로딩 완료 후 일정 시간 후 로딩 창 숨기기 (테스트용)
            setTimeout(function () {
                loadingOverlay.style.display = "none";
            }, 1000);
        }

        function New() {
            $('#Datatbody').empty();

            $('#popupOverlay3').fadeIn();
            $('#myInput1').focus()
            $('#myInput1').val('')
            $('#searchmaterialwidth').val('')
        }
        $('#datatablesliting').on('click', '.data-sliting', function () {
            var str = "";
            var tdArr = new Array(); // 배열 선언
            var checkBtn = $(this);

            var tr = checkBtn.parent().parent();
            var td = tr.children();

            var materialname = td.eq(3).text();
            var materialwidth = td.eq(4).text();
            var now = parseFloat(td.eq(6).text()); // 현재고를 숫자로 파싱
            var selectedMaterials = [];
            // 만약 materialname이 "A+B" 구조라면
            if (materialname.includes("+")) {
                $('.habjibtn').show();
                var parts = materialname.split("+");
                var partA = parts[0].trim(); // A 부분
                var partB = parts[1].trim(); // B 부분

                $('#Datatbody111').empty();

                $.ajax({
                    type: 'POST',
                    url: server + '/api/selectmaterial',
                    dataType: 'json',
                    contentType: 'application/json',
                    data: JSON.stringify({
                        materialname: parts[0].trim(),
                        materialwidth: td.eq(4).text()
                    }),
                    success: function (result) {
                        for (var i = 0; i < result.length; i++) {
                            // console.log(result)
                            $('#Datatbody111').append(
                                '<tr>' +
                                '<td><input type="checkbox" id="habjicheckbox"></td>' +
                                '<td>' + result[i].materialname + '</td>' +
                                '<td>' + result[i].materialwidth + '</td>' +
                                '<td>' + result[i].totalcount + '</td>' +

                                '</tr>'
                            );

                            // Add the conditionClass to the 'condition' cell
                        }
                    }
                });
                $.ajax({
                    type: 'POST',
                    url: server + '/api/selectmaterial',
                    dataType: 'json',
                    contentType: 'application/json',
                    data: JSON.stringify({
                        materialname: parts[1].trim(),
                        materialwidth: td.eq(4).text()
                    }),
                    success: function (result) {
                        for (var i = 0; i < result.length; i++) {
                            // console.log(result)
                            $('#Datatbody111').append(
                                '<tr>' +
                                '<td><input type="checkbox" id="habjicheckbox"></td>' +
                                '<td>' + result[i].materialname + '</td>' +
                                '<td>' + result[i].materialwidth + '</td>' +
                                '<td>' + result[i].totalcount + '</td>' +

                                '</tr>'
                            );

                            // Add the conditionClass to the 'condition' cell
                        }
                    }
                });
            } else {
                $('#Datatbody111').empty();
                $('.habjibtn').hide();

                $.ajax({
                    type: 'POST',
                    url: server + '/api/selectmaterial',
                    dataType: 'json',
                    contentType: 'application/json',
                    data: JSON.stringify({
                        materialname: td.eq(3).text(),
                        materialwidth: td.eq(4).text()
                    }),
                    success: function (result) {
                        for (var i = 0; i < result.length; i++) {
                            // console.log(result)
                            $('#Datatbody111').append(
                                '<tr>' +
                                '<td><input type="checkbox" id="sltcheckbox"></td>' +
                                '<td>' + materialname + '</td>' +
                                '<td>' + result[i].lotno + '</td>' +
                                '<td>' + result[i].materialwidth + '</td>' +
                                '<td>' + result[i].totalroll + '</td>' +
                                '<td>' + result[i].totalcount + '</td>' +
                                // '<td><a class="sliting">슬리팅</a></td>' +
                                // '<td><button id="calculateButton">합계</button></td>' +

                                '</tr>'
                            );

                            // Add the conditionClass to the 'condition' cell
                        }
                    }
                });
            }

        });
        function habji() {
            var selectedCount = $('#Datatbody111 input[type="checkbox"]:checked').length;

            if (selectedCount !== 2) {
                alert('자재를 두 가지 선택해주세요.');
            } else {
                var selectedMaterials = [];
                $('#Datatbody111 input[type="checkbox"]:checked').each(function (index) {
                    var tr = $(this).closest('tr');
                    var material = {
                        name: tr.find('td:nth-child(2)').text(),
                        width: tr.find('td:nth-child(3)').text(),
                        totalcount: tr.find('td:nth-child(4)').text()
                    };
                    selectedMaterials.push(material);

                    if (index === 0) {
                        $('#habji-materialname-save').val(selectedMaterials[index].name);
                        $('#habji-materialwidth-save').val(selectedMaterials[index].width);
                        $('#habji-classification-save').val('사급자재');
                        $('#habji-m-save').val(selectedMaterials[index].totalcount);
                        $('#habji-roll-save').val('1');
                        $('#habji-total-save').val(selectedMaterials[index].totalcount);
                    }
                    if (index === 1) {
                        $('#habji1-materialname-save').val(selectedMaterials[index].name);
                        $('#habji1-materialwidth-save').val(selectedMaterials[index].width);
                        $('#habji1-classification-save').val('사급자재');
                        $('#habji1-m-save').val(selectedMaterials[index].totalcount);
                        $('#habji1-roll-save').val('1');
                        $('#habji1-total-save').val(selectedMaterials[index].totalcount);
                    }
                });

                var today = new Date();
                var year = today.getFullYear();
                var month = today.getMonth() + 1;
                var day = today.getDate();

                var formattedDate = year + '-' + (month < 10 ? '0' : '') + month + '-' + (day < 10 ? '0' : '') + day;

                document.getElementById('habji-slitingdate-save').value = formattedDate;
                $('#habji-part-save').val('합지슬리팅');
                $('#popupOverlay6').fadeIn();
            }
        }



        $('#Datatbody111').on('click', '#calculateButton', function () {
            // 선택된 체크박스들에서 quantity 값을 합산할 변수
            var sumQuantity = 0;

            // 400과 800 체크박스에 대한 선택된 quantity 값을 합산
            $('#sltcheckbox:checked').each(function () {
                var quantity = $(this).closest('tr').find('td:eq(4)').text();
                sumQuantity += parseInt(quantity, 10) || 0;
            });

            // 합산된 결과를 콘솔에 출력
            alert(sumQuantity);

            // 여기에서 다른 동작을 추가하거나 결과를 특정 요소에 표시할 수 있습니다.
        });
        // 선택된 체크박스들의 quantity 값을 합산할 변수
        var sumQuantity = 0;

        $('#selectmaterialinput').on('change', '#sltinputcheckbox', function () {
            sumQuantity = 0;

            $('#sltinputcheckbox:checked').each(function () {
                var quantity = $(this).closest('tr').find('td:eq(5)').text();
                sumQuantity += parseInt(quantity, 10) || 0;
            });

            $('#slt-quantity-save').val(sumQuantity);

            $('#afterlotno1').empty();

            $('#sltinputcheckbox:checked').each(function () {
                var afterlotno = $(this).closest('tr').find('td:eq(2)').text();
                if (afterlotno && !$('#afterlotno1 option[value="' + afterlotno + '"]').length) {
                    // Add option if not already present
                    $('#afterlotno1').append('<option value="' + afterlotno + '">' + afterlotno + '</option>');
                }
            });
        });



        // 선택된 자재를 추적하는 배열
        var selectedMaterials = [];

        // 체크박스의 change 이벤트에 대한 핸들러
        $('#Datatbody111').on('change', '#habjicheckbox', function () {
            // 체크박스가 체크되었는지 확인
            if ($(this).is(':checked')) {
                // 선택된 자재의 이름 가져오기
                var materialName = $(this).closest('tr').find('td:eq(1)').text();

                // 중복 체크
                if (!selectedMaterials.includes(materialName)) {
                    selectedMaterials.push(materialName);
                } else {
                    $(this).prop('checked', false);
                    alert('이미 선택된 자재입니다.');
                }
            } else {
                // 체크가 해제되었을 때의 처리도 여기에 추가 가능
                // 선택된 자재 목록에서 제거
                var materialName = $(this).closest('tr').find('td:eq(1)').text();
                var index = selectedMaterials.indexOf(materialName);
                if (index !== -1) {
                    selectedMaterials.splice(index, 1);
                }
            }
        });
        // $('#datatablesliting1').on('change', '#sltcheckbox', function () {
        //     // 체크박스가 체크되었는지 확인
        //     if ($(this).is(':checked')) {
        //         var materailwidth = $(this).closest('tr').find('td:eq(3)').text();

        //         if (selectedMaterials.includes(materailwidth)) {
        //             // 선택이 이미 되어있는 경우
        //             $(this).prop('checked', false);
        //             alert('자재폭이 일치하지 않습니다');
        //         } else {
        //             selectedMaterials.push(materailwidth);
        //         }
        //     } else {
        //         var materailwidth = $(this).closest('tr').find('td:eq(3)').text();
        //         var index = selectedMaterials.indexOf(materailwidth);
        //         if (index !== -1) {
        //             selectedMaterials.splice(index, 1);
        //         }
        //     }
        // });



        $('#datatablesliting1').on('click', '.sliting', function () {
            // 현재 날짜를 가져옵니다.
            var sumQuantity = 0;

            // 400과 800 체크박스에 대한 선택된 quantity 값을 합산
            $('#sltcheckbox:checked').each(function () {
                var quantity = $(this).closest('tr').find('td:eq(5)').text();
                sumQuantity += parseInt(quantity, 10) || 0;
            });

            // 합산된 결과를 콘솔에 출력
            // alert(sumQuantity);

            var today = new Date();

            // 년, 월, 일을 가져옵니다.
            var year = today.getFullYear();
            var month = today.getMonth() + 1; // 월은 0부터 시작하므로 1을 더합니다.
            var day = today.getDate();

            // 'YYYY-MM-DD' 형식의 날짜 문자열을 만듭니다.
            var formattedDate = year + '-' + (month < 10 ? '0' : '') + month + '-' + (day < 10 ? '0' : '') + day;

            // id가 'slitingdate-save'인 input 요소의 값을 설정합니다.
            document.getElementById('slitingdate-save').value = formattedDate;

            var str = "";
            var tdArr = new Array();// 배열 선언            
            var checkBtn = $(this);

            var tr = checkBtn.parent().parent();
            var td = tr.children();

            var selectedMaterials = [];
            $('#Datatbody111 #sltcheckbox:checked').each(function (index) {
                var tr = $(this).closest('tr');
                var material = {
                    name: tr.find('td:nth-child(2)').text(),
                    lotno: tr.find('td:nth-child(3)').text(),
                    width: tr.find('td:nth-child(4)').text(),
                };
                selectedMaterials.push(material);
                if (index === 0) {
                    $.ajax({
                        type: 'POST',
                        url: server + '/api/selectmaterialinput',
                        dataType: 'json',
                        contentType: 'application/json',
                        data: JSON.stringify({
                            materialname: selectedMaterials[index].name,
                            lotno: selectedMaterials[index].lotno,
                            materialwidth: selectedMaterials[index].width
                        }),
                        success: function (result) {
                            for (var i = 0; i < result.length; i++) {
                                $('#selectmaterialinput').append(
                                    '<tr>' +
                                    '<td><input type="checkbox" id="sltinputcheckbox"></td>' +
                                    '<td>' + result[i].materialname + '</td>' +
                                    '<td>' + result[i].lotno + '</td>' +
                                    '<td>' + result[i].materialwidth + '</td>' +
                                    '<td>' + result[i].roll + '</td>' +
                                    '<td>' + result[i].quantity + '</td>' +
                                    '</tr>'
                                );

                                // Add the conditionClass to the 'condition' cell
                            }
                        }
                    });
                }
                if (index === 1) {
                    $.ajax({
                        type: 'POST',
                        url: server + '/api/selectmaterialinput',
                        dataType: 'json',
                        contentType: 'application/json',
                        data: JSON.stringify({
                            materialname: selectedMaterials[index].name,
                            lotno: selectedMaterials[index].lotno,
                            materialwidth: selectedMaterials[index].width
                        }),
                        success: function (result) {
                            for (var i = 0; i < result.length; i++) {
                                $('#selectmaterialinput').append(
                                    '<tr>' +
                                    '<td><input type="checkbox" id="sltinputcheckbox"></td>' +
                                    '<td>' + result[i].materialname + '</td>' +
                                    '<td>' + result[i].lotno + '</td>' +
                                    '<td>' + result[i].materialwidth + '</td>' +
                                    '<td>' + result[i].roll + '</td>' +
                                    '<td>' + result[i].quantity + '</td>' +

                                    '</tr>'
                                );

                                // Add the conditionClass to the 'condition' cell
                            }
                        }
                    });
                }
            });
            $('#selectmaterialinput').empty()


            // $('#slitingdate-save').val(slitingdate)
            $('#slt-part-save').val('슬리팅')
            $('#slt-materialname-save').val(materialname)
            $('#slt-classification-save').val('사급자재')
            $('#slt-materialwidth-save').val(materialwidth)
            $('#slt-m-save').val(quantity)
            $('#slt-roll-save').val('1')
            $('#slt-total-save').val(sumQuantity)
            $('#popupOverlay5').fadeIn()
        })




        // $('#datatablesliting').on('click', '.data-sliting', function () {
        // $('#Datatbody').empty();

        // var str = "";
        // var tdArr = new Array();// 배열 선언            
        // var checkBtn = $(this);

        // var tr = checkBtn.parent().parent();
        // var td = tr.children();


        // var materialname = td.eq(6).text();
        // var materialwidth = td.eq(7).text();
        // var soyo = td.eq(10).text();
        // $('#myInput1').val(materialname)
        // $('#myInput2').val(soyo)
        // $('#searchmaterialwidth').val(materialwidth)

        // // popupOverlay2를 뒤로 보냄


        // $.ajax({
        //     type: 'POST',
        //     url: server + '/api/materialrealstock',
        //     dataType: 'json',
        //     contentType: 'application/json',
        //     data: JSON.stringify({
        //         searchText: $('#myInput1').val(),
        //         materialwidth: $('#searchmaterialwidth').val()
        //     }),
        //     success: function (result) {
        //         $('#Datatbody').empty();



        //         for (var i = 0; i < result.length; i++) {
        //             $('#Datatbody').append(
        //                 '<tr>' +
        //                 '<td>' + result[i].materialname + '</td>' +
        //                 '<td>' + result[i].classification + '</td>' +
        //                 '<td style="text-align:right;">' + result[i].materialwidth.toLocaleString() + '</td>' +
        //                 '<td style="text-align:right;">' + result[i].quantity.toLocaleString() + '</td>' +
        //                 '<td style="text-align:right;">' + result[i].roll.toLocaleString() + '</td>' +
        //                 '<td style="text-align:right;">' + result[i].totalquantity.toLocaleString() + '</td>' +
        //                 '<td><a class="data-edit"  style="cursor:pointer; color:navy;" onclick="selectRow(' + i + ')">슬리팅</a></td>' +

        //                 '</tr>'
        //             );
        //             $("td#slim").hide();
        //         }

        //         var selectedData = []; // 선택된 데이터를 저장할 배열

        //         // 행 클릭 시 해당 데이터를 배열에 하는 함수
        //         window.selectRow = function (index) {
        //             var rowData = result[index]; // 선택된 행의 데이터
        //             selectedData.push(rowData); // 선택된 데이터를 배열에 추가
        //             var materialname = rowData.materialname;
        //             var classification = rowData.classification;
        //             var lotno = rowData.lotno;
        //             var materialwidth = rowData.materialwidth;
        //             var totalquantity = rowData.totalquantity;
        //             var sqmprice = rowData.sqmprice;
        //             var codenumber = rowData.codenumber;
        //             var manufacturedate = rowData.manufacturedate;
        //             var expirationdate = rowData.expirationdate;
        //             console.log(selectedData);
        //         }

        //     }
        // });

        // })
        function New1() {
            // 페이지 상의 모든 체크박스의 체크를 해제
            $('#Datatbody111 input[type="checkbox"]').prop('checked', false);
            $('.habjibtn').hide();
            // 선택된 자재 목록 초기화
            selectedMaterials = [];

            // 로컬 스토리지에서 데이터도 초기화
            localStorage.removeItem('selectedMaterials');
            $('#Datatbody11').empty();
            $('#Datatbody111').empty();
            $.ajax({
                type: 'POST',
                url: server + '/api/materialsoyojisi',
                dataType: 'json',
                contentType: 'application/json',
                data: JSON.stringify({}),
                success: function (result) {
                    for (var i = 0; i < result.length; i++) {
                        var conditionClass = result[i].condition === '부족' ? 'insufficient' : ''; // Add conditionClass based on the condition value
                        var conditionStyle = result[i].condition === '부족' ? 'background-color: red; color: white;' : 'background-color: green; color: white;'; // Update conditionStyle based on the condition value

                        // Check if the condition is '부족' before adding "슬리팅"
                        var slittingLink = result[i].condition === '부족' ? '<td><a class="data-sliting" id="datasliting" style="cursor:pointer; font-weight:bold;">재고상세</a></td>' : '<td></td>';

                        $('#Datatbody11').append(
                            '<tr>' +
                            '<td>' + result[i].productdate + '</td>' +
                            '<td>' + result[i].lotno + '</td>' +
                            '<td>' + result[i].bomno + '</td>' +
                            '<td>' + result[i].materialname + '</td>' +
                            '<td style="text-align:right;">' + result[i].swidth.toLocaleString() + '</td>' +
                            '<td class="soyo-value" style="text-align:right;">' + result[i].soyo.toLocaleString() + '</td>' +
                            '<td class="soyo-value" style="text-align:right;">' + result[i].materialnum.toLocaleString() + '</td>' +
                            '<td class="soyo-value" style="text-align:right;">' + result[i].materialnum.toLocaleString() + '</td>' +
                            '<td class="soyo-value" style="text-align:right;">' + result[i].diff.toLocaleString() + '</td>' +
                            '<td class="soyo-value" style="' + conditionStyle + '">' + result[i].condition + '</td>' + // Apply conditionStyle here
                            slittingLink + // Add "슬리팅" link conditionally
                            '</tr>'
                        );

                        // Add the conditionClass to the 'condition' cell
                        $('#Datatbody11 tr:last-child td.so-yo-value').addClass(conditionClass);
                    }
                }
            });

            $('#popupOverlay2').fadeIn();
            $('#myInput1').focus();
            $('#myInput1').val('');
            $('#searchmaterialwidth').val('');
        }





        function Datasave() {

        }
        function PODataedit() {



            if ($('#count-POedit').val() === '' || $('#count-POedit').val() === '0') {
                var notification = $('<div class="notification"><img src="/img/테크온로고.PNG" alt="Notification Icon"><span style="font-weight:bold; color:red;" class="notification-message">PO수량 확인바랍니다</span></div>');
                $('body').append(notification);
                setTimeout(function () {
                    notification.fadeOut(function () {
                        $(this).remove();
                    });
                }, 3000);

            } else {
                var tr = $(this).closest('tr'); // 현재 버튼이 속한 행(tr)을 가져옵니다.
                var tdArr = tr.find('td'); // 행(tr)에서 모든 셀(td)을 가져옵니다.

                var POeditcount = $('#count-POedit', window.opener.document).val(); // 다른 창에서 값을 가져옵니다.

                // 원하는 셀에 접근하여 값을 변경합니다.
                tdArr.eq(7).text(POeditcount); // 8번째 셀의 값을 변경 (0부터 시작하는 인덱스)


                $('#popupOverlay4').fadeOut();

                var total8 = 0;
                var total9 = 0;
                $('#Podatatable td:nth-child(8)').each(function () {
                    var count8 = parseFloat($(this).text().replace(/,/g, ''));
                    if (!isNaN(count8)) {
                        total8 += count8;
                    }
                });

                $('#Podatatable td:nth-child(9)').each(function () {
                    var count9 = parseFloat($(this).text().replace(/,/g, ''));
                    if (!isNaN(count9)) {
                        total9 += count9;
                    }
                });
                // 합계 표시
                $('#Podatatable tfoot').remove(); // 기존의 tfoot 제거
                $('#Podatatable').append(
                    '<tfoot>' +
                    '<tr>' +
                    '<td style="border:1px solid silver; background-color:whitesmoke;"colspan="7">합계</td>' +
                    '<td style="border:1px solid silver; text-align:right;"><strong>' + addCommas(total8.toFixed(0)) + '</strong></td>' +
                    '<td style="border:1px solid silver; text-align:right;"><strong>' + addCommas(total9.toFixed(0)) + '</strong></td>' +
                    '<td style="border:1px solid silver; background-color:whitesmoke; "colspan="2"></td>' +
                    '</tr>' +
                    '</tfoot>'
                );

                var notification = $('<div class="notification"><img src="/img/테크온로고.PNG" alt="Notification Icon"><span style="font-weight:bold; color:navy;" class="notification-message">PO수량 수정되었습니다</span></div>');
                $('body').append(notification);
                setTimeout(function () {
                    notification.fadeOut(function () {
                        $(this).remove();
                    });
                }, 3000); // 3초 후에 알림을 사라지게 설정
            }

        }

        // function Dataedit() {



        //     if ($('#quantity').val() === '' || $('#roll').val() === '0') {
        //         var notification = $('<div class="notification"><img src="/img/테크온로고.PNG" alt="Notification Icon"><span style="font-weight:bold; color:red;" class="notification-message">공란 확인바랍니다</span></div>');
        //         $('body').append(notification);
        //         setTimeout(function () {
        //             notification.fadeOut(function () {
        //                 $(this).remove();
        //             });
        //         }, 3000);

        //     } else {
        //         if (confirm("원자재 슬리팅지시를 등록 하시겠습니까??") == true) {
        //             // printpage()
        //             const date = new Date();

        //             var day = date.getDate();
        //             var month = date.getMonth() + 1;
        //             var year = date.getFullYear();

        //             console.log((month).length, day.length)

        //             if (month === 1 || month === 2 || month === 3 || month === 4 || month === 5 || month === 6 || month === 7 || month === 8 || month === 9) {
        //                 month = '0' + month
        //                 console.log(month)
        //             }

        //             if (day === 1 || day === 2 || day === 3 || day === 4 || day === 5 || day === 6 || day === 7 || day === 8 || day === 9) {
        //                 day = '0' + day
        //                 console.log(day)
        //             }


        //             // This arrangement can be altered based on how we want the date's format to appear.
        //             let currentDate = `${year}-${month}-${day}`;

        //             var materialname = $('#materialname').val();

        //             var materialwidth = $('#materialwidth').val();
        //             var materialwidthcomma = materialwidth.replace(/,/g, "");
        //             var materialcode = $('#materialcode').val() + '-' + materialwidth.replace(/,/g, "");
        //             var manufacturedate = $('#datepicker1').val();
        //             var input = $('#input').val();
        //             var house = $('#house-select').val();
        //             var materialday = $('#day').val();
        //             var customer = $('#customer').val();
        //             var lotno = $('#lotno').val();
        //             var roll = $('#roll').val();
        //             var quantity = $('#quantity').val();

        //             var classification = $('#classification').val();
        //             var sum = $('#quantity').val() * $('#roll').val();;
        //             var today = new Date();
        //             var dd = String(today.getDate()).padStart(2, '0');
        //             var mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!
        //             var yyyy = today.getFullYear();

        //             today = yyyy + '-' + mm + '-' + dd

        //             var sumdate = new Date(Date.parse(manufacturedate) + parseInt(materialday) * 1000 * 60 * 60 * 24);
        //             var sumdd = String(sumdate.getDate()).padStart(2, '0');
        //             var summm = String(sumdate.getMonth() + 1).padStart(2, '0'); //January is 0!
        //             var sumyyyy = sumdate.getFullYear();

        //             var expirationdate = sumyyyy + '-' + summm + '-' + sumdd
        //             var resultdate = sumyyyy + '-' + summm + '-' + sumdd

        //             // .input('m', sql.Float, req.body.m)
        //             // .input('roll', sql.Float, req.body.roll)
        //             var rowCount = $('#datatable1tbody tr').length + 1;
        //             for (var i = 1; i < rowCount; i++) {
        //                 $.ajax({
        //                     type: 'POST',
        //                     url: server + '/api/slimdeletematerial',
        //                     dataType: 'json',
        //                     contentType: 'application/json',
        //                     data: JSON.stringify({

        //                         "slitingdate": today,
        //                         "part": $('#part-select').val(),
        //                         "materialname": $('#materialname').val(),
        //                         "classification": $('#classification').val(),
        //                         "expirationdate": $('#exp-delete').val(),
        //                         "materialwidth": $('#materialwidth').val(),
        //                         "m": $('#quantity').val(),
        //                         "roll": $('#roll').val(),
        //                         "total": $('#totalquantity').val(),
        //                         "aftermaterialwidth": $('#lotno' + i + '').val(),
        //                         "afterm": $('#mwidth' + i + '').val(),
        //                         "afterroll": $('#roll' + i + '').val(),
        //                         "aftertotal": $('#sumquantity' + i + '').val(),
        //                         "trash": $('#trash' + i + '').val()
        //                     }),
        //                     success: function (result) {

        //                     }
        //                 })
        //             }





        //             // for (i = 0; i < roll; i++) {
        //             //     $.ajax({
        //             //         type: 'POST',
        //             //         url: server + '/api/materialinputsave',
        //             //         dataType: 'json',
        //             //         contentType: 'application/json',
        //             //         data: JSON.stringify({

        //             //             "materialname": materialname,
        //             //             "input": "슬리팅입고",
        //             //             "codenumber": $('#codenumber-delete').val(),
        //             //             "manufacturedate": $('#manu-delete').val(),
        //             //             "expirationdate": $('#exp-delete').val(),
        //             //             "materialwidth": materialwidthcomma,
        //             //             "classification": classification,
        //             //             "date": currentDate,
        //             //             "lotno": lotno,
        //             //             "quantity": quantity1,
        //             //             "part": '입고완료',
        //             //             "sqmprice": sqmprice,
        //             //             "house": house
        //             //         }),
        //             //         success: function (result) {

        //             //         }
        //             //     })

        //             // }
        //             setTimeout(function () {
        //                 load()
        //             }, 50); // 3초 후에 알림을 사라지게 설정

        //             $('#popupOverlay1').fadeOut();

        //         }

        //     }
        // }

        function Dataedit() {
            var afterCount = $('#slitingafter tr').length;
            var finalCount = $('#datatable1tbody1 tr').length


            if (confirm("슬리팅 정보를 등록 하시겠습니까??") == true) {


                if (afterCount === finalCount) {
                    for (var i = 1; i < finalCount + 1; i++) {
                        $.ajax({
                            type: 'POST',
                            url: server + '/api/slitingupdate',
                            dataType: 'json',
                            contentType: 'application/json',
                            data: JSON.stringify({
                                id: parseInt($('#id-edit1').val()) + i - 1,
                                finalmaterialwidth: $('#finalmaterialwidth' + i + '').val(),
                                finalm: $('#finalm' + i + '').val(),
                                finalroll: $('#finalroll' + i + '').val(),
                                finaltotal: $('#finalt' + i + '').val(),
                            }),
                            success: function (result) {
                            }
                        });
                    }

                } else {
                    for (var i = 1; i < finalCount + 1; i++) {
                        $.ajax({
                            type: 'POST',
                            url: server + '/api/slitingupdate',
                            dataType: 'json',
                            contentType: 'application/json',
                            data: JSON.stringify({
                                id: parseInt($('#id-edit1').val()) + i - 1,
                                finalmaterialwidth: $('#finalmaterialwidth' + i + '').val(),
                                finalm: $('#finalm' + i + '').val(),
                                finalroll: $('#finalroll' + i + '').val(),
                                finaltotal: $('#finalt' + i + '').val(),
                            }),
                            success: function (result) {
                            }
                        });
                    }
                    $.ajax({
                        type: 'POST',
                        url: server + '/api/insertslitingupdate',
                        dataType: 'json',
                        contentType: 'application/json',
                        data: JSON.stringify({

                            slitingdate: $('#slitingdate').val(),
                            part: $('#slt-part').val(),
                            materialname: $('#slt-materialname').val(),
                            classification: $('#slt-classification').val(),
                            materialwidth: $('#slt-materialwidth').val(),
                            m: $('#slt-m').val(),
                            roll: $('#slt-roll').val(),
                            total: $('#slt-total').val(),
                            aftermaterialwidth: '0',
                            afterm: '0',
                            afterroll: '0',
                            aftertotal: '0',
                            finalmaterialwidth: $('#finalmaterialwidth' + parseInt(finalCount) + '').val(),
                            finalm: $('#finalm' + parseInt(finalCount) + '').val(),
                            finalroll: $('#finalroll' + parseInt(finalCount) + '').val(),
                            finaltotal: $('#finalt' + parseInt(finalCount) + '').val(),
                            orderno: $('#orderno').val(),



                        }),
                        success: function (result) {


                        }
                    })

                }


                $('#popupOverlay4').fadeOut();
                setTimeout(function () {
                    load()
                }, 50); // 3초 후에 알림을 사라지게 설정
                var notification = $('<div class="notification"><img src="/img/테크온로고.PNG" alt="Notification Icon"><span class="notification-message" style="color:navy;">슬리팅 입력 완료</span></div>');
                $('body').append(notification);
                setTimeout(function () {
                    notification.fadeOut(function () {
                        $(this).remove();
                    });
                }, 3000);
            } else {
                return false;
            }
        }
        function Dataedit2() {
            var rowCount = $('#slttable1 tbody tr').length + 1;
            if (confirm("슬리팅 작업지시를 등록 하시겠습니까??") == true) {

                for (var i = 1; i < rowCount; i++) {
                    $.ajax({
                        type: 'POST',
                        url: server + '/api/insertsltmaterial',
                        dataType: 'json',
                        contentType: 'application/json',
                        data: JSON.stringify({

                            slitingdate: $('#slitingdate-save').val(),
                            part: $('#slt-part-save').val(),
                            materialname: $('#slt-materialname-save').val(),
                            classification: $('#slt-classification-save').val(),
                            materialwidth: $('#slt-materialwidth-save').val(),
                            m: $('#slt-m-save').val(),
                            roll: $('#slt-roll-save').val(),
                            total: $('#slt-total-save').val(),
                            aftermaterialwidth: $('#aftermaterialwidth' + i + '').val(),
                            afterm: $('#afterm' + i + '').val(),
                            afterroll: $('#afterroll' + i + '').val(),
                            aftertotal: $('#aftert' + i + '').val(),
                            finalmaterialwidth: '0',
                            finalm: '0',
                            finalroll: '0',
                            finaltotal: '0',
                            orderno: 'slt-' + $('#slitingdate-save').val() + $('#slt-materialname-save').val() + $('#slt-materialwidth-save').val()
                        }),
                        success: function (result) {
                            // 성공 처리 코드 추가
                        }
                    });

                }




                $('#popupOverlay5').fadeOut();
                setTimeout(function () {
                    load()
                }, 50); // 3초 후에 알림을 사라지게 설정
                var notification = $('<div class="notification"><img src="/img/테크온로고.PNG" alt="Notification Icon"><span class="notification-message" style="color:navy;">슬리팅 작업지시 완료</span></div>');
                $('body').append(notification);
                setTimeout(function () {
                    notification.fadeOut(function () {
                        $(this).remove();
                    });
                }, 3000);
            } else {
                return false;
            }
        }
        function Dataedit3() {
            var rowCount = $('#slttable2 tbody tr').length + 1;
            if (confirm("합지 슬리팅 작업지시를 등록 하시겠습니까??") == true) {

                $.ajax({
                    type: 'POST',
                    url: server + '/api/insertsltmaterial',
                    dataType: 'json',
                    contentType: 'application/json',
                    data: JSON.stringify({

                        slitingdate: $('#habji-slitingdate-save').val(),
                        part: $('#habji-part-save').val(),
                        materialname: $('#habji-materialname-save').val(),
                        classification: $('#habji-classification-save').val(),
                        materialwidth: $('#habji-materialwidth-save').val(),
                        m: $('#habji-m-save').val(),
                        roll: $('#habji-roll-save').val(),
                        total: $('#habji-total-save').val(),
                        aftermaterialwidth: $('#habji-aftermaterialwidth1').val(),
                        afterm: $('#habji-afterm1').val(),
                        afterroll: $('#habji-afterroll1').val(),
                        aftertotal: $('#habji-aftert1').val(),
                        finalmaterialwidth: '0',
                        finalm: '0',
                        finalroll: '0',
                        finaltotal: '0',
                        trash: '',
                        orderno: 'habji-' + $('#habji-slitingdate-save').val() + $('#habji-materialname-save').val() + $('#habji-materialwidth-save').val()
                    }),
                    success: function (result) {
                        // 성공 처리 코드 추가
                    }
                });
                $.ajax({
                    type: 'POST',
                    url: server + '/api/insertsltmaterial',
                    dataType: 'json',
                    contentType: 'application/json',
                    data: JSON.stringify({

                        slitingdate: $('#habji-slitingdate-save').val(),
                        part: $('#habji-part-save').val(),
                        materialname: $('#habji1-materialname-save').val(),
                        classification: $('#habji1-classification-save').val(),
                        materialwidth: $('#habji1-materialwidth-save').val(),
                        m: $('#habji1-m-save').val(),
                        roll: $('#habji1-roll-save').val(),
                        total: $('#habji1-total-save').val(),
                        aftermaterialwidth: $('#habji-aftermaterialwidth1').val(),
                        afterm: $('#habji-afterm1').val(),
                        afterroll: $('#habji-afterroll1').val(),
                        aftertotal: $('#habji-aftert1').val(),
                        finalmaterialwidth: '0',
                        finalm: '0',
                        finalroll: '0',
                        finaltotal: '0',
                        trash: '',
                        orderno: 'habji-' + $('#habji-slitingdate-save').val() + $('#habji-materialname-save').val() + $('#habji-materialwidth-save').val()
                    }),
                    success: function (result) {
                        // 성공 처리 코드 추가
                    }
                });






                $('#popupOverlay6').fadeOut();
                setTimeout(function () {
                    load()
                }, 50); // 3초 후에 알림을 사라지게 설정
                var notification = $('<div class="notification"><img src="/img/테크온로고.PNG" alt="Notification Icon"><span class="notification-message" style="color:navy;">슬리팅 작업지시 완료</span></div>');
                $('body').append(notification);
                setTimeout(function () {
                    notification.fadeOut(function () {
                        $(this).remove();
                    });
                }, 3000);
            } else {
                return false;
            }
        }








        // 천 단위마다 콤마를 추가하는 함수
        function addCommas(value) {
            return value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }

        function Datadelte() {
            $('#popupOverlay2').fadeIn();
        }


        $(document).on('click', '.data-delete', function () {
            $(this).closest('tr').remove();
            var total8 = 0;
            var total9 = 0;
            $('#Podatatable td:nth-child(8)').each(function () {
                var count8 = parseFloat($(this).text().replace(/,/g, ''));
                if (!isNaN(count8)) {
                    total8 += count8;
                }
            });

            $('#Podatatable td:nth-child(9)').each(function () {
                var count9 = parseFloat($(this).text().replace(/,/g, ''));
                if (!isNaN(count9)) {
                    total9 += count9;
                }
            });
            // 합계 표시
            $('#Podatatable tfoot').remove(); // 기존의 tfoot 제거
            $('#Podatatable').append(
                '<tfoot>' +
                '<tr>' +
                '<td style="border:1px solid silver; background-color:whitesmoke;"colspan="7">합계</td>' +
                '<td style="border:1px solid silver; text-align:right;"><strong>' + addCommas(total8.toFixed(0)) + '</strong></td>' +
                '<td style="border:1px solid silver; text-align:right;"><strong>' + addCommas(total9.toFixed(0)) + '</strong></td>' +
                '<td style="border:1px solid silver; background-color:whitesmoke; "colspan="2"></td>' +
                '</tr>' +
                '</tfoot>'
            );

            var notification = $('<div class="notification"><img src="/img/테크온로고.PNG" alt="Notification Icon"><span class="notification-message"> 제품이 삭제되었습니다.</span></div>');
            $('body').append(notification);
            setTimeout(function () {
                notification.fadeOut(function () {
                    $(this).remove();
                });
            }, 3000); // 3초 후에 알림을 사라지게 설정
        });



    </script>
    <script>
        function settingDate() {
            const date = new Date();

            var day = date.getDate();
            var month = date.getMonth() + 1;
            var year = date.getFullYear();


            if (month === 1 || month === 2 || month === 3 || month === 4 || month === 5 || month === 6 || month === 7 || month === 8 || month === 9) {
                month = '0' + month
            }

            if (day === 1 || day === 2 || day === 3 || day === 4 || day === 5 || day === 6 || day === 7 || day === 8 || day === 9) {
                day = '0' + day
            }


            // This arrangement can be altered based on how we want the date's format to appear.
            let currentDate = `${year}-${month}-${day}`;


            $('#datepicker1').val(currentDate);
            $('#datepicker2').val(currentDate);
            $('#datepicker3').val(currentDate);

        }
    </script>
    <script>
        function POsearching() {
            showLoading()
            var startDate = new Date($('#datepicker2').val());
            var endDate = new Date($('#datepicker3').val());

            if (startDate > endDate) {
                var notification = $('<div class="notification"><img src="/img/테크온로고.PNG" alt="Notification Icon"><span style="color:red;" class="notification-message">조회 기간 확인바랍니다.</span></div>');
                $('body').append(notification);
                setTimeout(function () {
                    notification.fadeOut(function () {
                        $(this).remove();
                    });
                }, 3000); // 3초 후에 알림을 사라지게 설정
            } else {
                load()
            };




        }

        function sum(event) {
            if (event.keyCode === 13) { // Enter 키를 눌렀을 때
                for (var i = 1; i < $('#datatable1tbody tr').length + 1; i++) {
                    $('#sumquantity' + i + '').val($('#roll' + i + '').val() * $('#mwidth' + i + '').val())
                }

            }
        }
        function handleKeyPress(event) {
            if (event.keyCode === 13) { // Enter 키를 눌렀을 때

                $.ajax({
                    type: 'POST',
                    url: server + '/api/materialrealstock',
                    dataType: 'json',
                    contentType: 'application/json',
                    data: JSON.stringify({
                        searchText: $('#myInput1').val(),
                        materialwidth: $('#searchmaterialwidth').val()
                    }),
                    success: function (result) {
                        $('#Datatbody').empty();



                        for (var i = 0; i < result.length; i++) {
                            $('#Datatbody').append(
                                '<tr>' +
                                '<td>' + result[i].materialname + '</td>' +
                                '<td>' + result[i].classification + '</td>' +
                                '<td style="text-align:right;">' + result[i].materialwidth.toLocaleString() + '</td>' +
                                '<td style="text-align:right;">' + result[i].quantity.toLocaleString() + '</td>' +
                                '<td style="text-align:right;">' + result[i].roll.toLocaleString() + '</td>' +
                                '<td style="text-align:right;">' + result[i].totalquantity.toLocaleString() + '</td>' +
                                '<td><a class="data-edit"  style="cursor:pointer; color:navy;" onclick="selectRow(' + i + ')">슬리팅</a></td>' +
                                // '<td id="slim">' + result[i].sqmprice.toLocaleString() + '</td>' +
                                // '<td id="slim">' + result[i].codenumber + '</td>' +
                                // '<td id="slim">' + result[i].manufacturedate + '</td>' +
                                // '<td id="slim">' + result[i].expirationdate + '</td>' +
                                // '<td id="slim">' + result[i].materialid + '</td>' +
                                '</tr>'
                            );
                            $("td#slim").hide();
                        }

                        var selectedData = []; // 선택된 데이터를 저장할 배열

                        // 행 클릭 시 해당 데이터를 배열에 추가하는 함수
                        window.selectRow = function (index) {
                            var rowData = result[index]; // 선택된 행의 데이터
                            selectedData.push(rowData); // 선택된 데이터를 배열에 추가
                            var materialname = rowData.materialname;
                            var classification = rowData.classification;
                            var lotno = rowData.lotno;
                            var materialwidth = rowData.materialwidth;
                            var totalquantity = rowData.totalquantity;
                            var sqmprice = rowData.sqmprice;
                            var codenumber = rowData.codenumber;
                            var manufacturedate = rowData.manufacturedate;
                            var expirationdate = rowData.expirationdate;
                            console.log(selectedData);
                        }

                    }
                });



            }
        }
    </script>
    <script>
        // function load() {
        //     $('#materialinputtbody').empty()

        // }
        function Dataedit1() {
            if (confirm("슬리팅 실적을 입력 하시겠습니까??") == true) {

                $.ajax({
                    type: 'POST',
                    url: server + '/api/slitingsiljok3',
                    dataType: 'json',
                    contentType: 'application/json',
                    data: JSON.stringify({

                        id: '19',
                        finalmaterialwidth: $('#lotno1').val(),
                        finalm: $('#mwidth1').val(),
                        finalroll: $('#roll1').val(),
                        finaltotal: $('#sumquantity1').val(),
                        finaltrash: $('#trash1').val(),





                    }),
                    success: function (result) {
                    }
                })

                $.ajax({
                    type: 'POST',
                    url: server + '/api/slitingsiljok3',
                    dataType: 'json',
                    contentType: 'application/json',
                    data: JSON.stringify({

                        id: '20',
                        finalmaterialwidth: $('#lotno2').val(),
                        finalm: $('#mwidth2').val(),
                        finalroll: $('#roll2').val(),
                        finaltotal: $('#sumquantity2').val(),
                        finaltrash: $('#trash2').val(),





                    }),
                    success: function (result) {
                    }
                })

                $('#popupOverlay4').fadeOut();
                setTimeout(function () {
                    load()
                }, 50); // 3초 후에 알림을 사라지게 설정
                var notification = $('<div class="notification"><img src="/img/테크온로고.PNG" alt="Notification Icon"><span class="notification-message" style="color:navy;">슬리팅 입력 완료</span></div>');
                $('body').append(notification);
                setTimeout(function () {
                    notification.fadeOut(function () {
                        $(this).remove();
                    });
                }, 3000);
            } else {
                return false;
            }

        }

        function add1() {

            console.log(11)
            // var rowCount = $('#datatable1tbody tr').length + 1;
            // var quantity = $('#quantity').val()
            // var newRow = '<tr>' +
            //     '<td><input type="text" style="text-align:right;" class="slitting-input" id="lotno' + rowCount + '"></td>' +
            //     '<td><input type="text" style="text-align:right;" value="' + quantity + '" class="slitting-input" id="mwidth' + rowCount + '"> </td>' +
            //     '<td><input type="text" style="text-align:right;" onkeydown="sum(event)" class="slitting-input" id="roll' + rowCount + '"></td>' +
            //     '<td><input type="text" style="text-align:right;" class="slitting-input" id="sumquantity' + rowCount + '"></td>' +
            //     '<td><select id="trash' + rowCount + '" class="select-box">' +
            //     '<option value=""></option>' + // Set a value for the first option tag
            //     '<option value="폐기">폐기</option>' +
            //     '</select></td>' +
            //     '<td><a class="datalotdelete" style="cursor:pointer; color:red;">삭제</a></td>' +
            //     '</tr>';



            // $('#datatable1tbody').append(newRow);
        }

        function add2() {

            var rowCount = $('#datatable2tbody tr').length + 1;
            var quantity = $('#quantity').val()
            var newRow = '<tr>' +
                '<td><input type="text" style="text-align:right;" class="slitting-input" id="lotno' + rowCount + '"></td>' +
                '<td><input type="text" style="text-align:right;" value="' + quantity + '" class="slitting-input" id="mwidth' + rowCount + '"> </td>' +
                '<td><input type="text" style="text-align:right;" onkeydown="sum(event)" class="slitting-input" id="roll' + rowCount + '"></td>' +
                '<td><input type="text" style="text-align:right;" class="slitting-input" id="sumquantity' + rowCount + '"></td>' +
                '<td><select id="trash' + rowCount + '" class="select-box">' +
                '<option value=""></option>' + // Set a value for the first option tag
                '<option value="폐기">폐기</option>' +
                '</select></td>' +
                '<td><a class="datalotdelete" style="cursor:pointer; color:red;">삭제</a></td>' +
                '</tr>';



            $('#datatable2tbody').append(newRow);
        }

        function load() {
            $('#materialinputtbody').empty();
            $.ajax({
                type: 'POST',
                url: server + '/api/selectslitingplan',
                dataType: 'json',
                success: function (data) {
                    if (!Array.isArray(data) || data.length === 0) {
                        // Handle empty data or invalid data, if required.
                        return;
                    }

                    var groupedData = groupBySlitingDate(data);

                    for (var date in groupedData) {
                        if (groupedData.hasOwnProperty(date)) {
                            var groupsByPart = groupedData[date];
                            var rowCount = 0;

                            for (var part in groupsByPart) {
                                if (groupsByPart.hasOwnProperty(part)) {
                                    var groupByPart = groupsByPart[part];
                                    var rows = groupByPart.rows;
                                    var rowSpan = rows.length;

                                    for (var i = 0; i < rows.length; i++) {
                                        var rowData = rows[i];
                                        var slitingDateCell = rowCount === 0 ? `<td style="border:1px solid silver;" rowspan="${rowSpan}">${rowData.slitingdate}</td>` : '';
                                        var partCell = rowCount === 0 ? `<td style="border:1px solid silver;" rowspan="${rowSpan}">${rowData.part}</td>` : '';


                                        var isHapjiSlitting = rowData.part === "합지슬리팅";

                                        var afterMaterialWidthCell, afterMCell, afterRollCell, afterTotalCell;
                                        if (isHapjiSlitting) {
                                            partCell = rowCount === 0 ? `<td style="text-align:center; background-color:whitesmoke; border:1px solid silver;" rowspan="${rowSpan}">${rowData.part}</td>` : '';
                                            materialNameCell = `<td style="text-align:center; border:1px solid silver;">${rowData.materialname}</td>`;
                                            classificationCell = `<td style="text-align:center; border:1px solid silver;">${rowData.classification}</td>`;
                                            materialWidthCell = `<td style="text-align:right; border:1px solid silver;">${rowData.materialwidth}</td>`;
                                            mCell = `<td style="text-align:right; border:1px solid silver;">${rowData.m}</td>`;
                                            rollCell = `<td style="text-align:center; border:1px solid silver;">${rowData.roll}</td>`;
                                            totalCell = `<td style="text-align:right; border:1px solid silver;">${rowData.total}</td>`;
                                            afterMaterialWidthCell = rowCount === 0 ? `<td style="text-align:right; border:1px solid silver;"  rowspan="${rowSpan}">${rowData.aftermaterialwidth}</td>` : '';
                                            afterMCell = rowCount === 0 ? `<td style="text-align:right; border:1px solid silver;" rowspan="${rowSpan}">${rowData.afterm}</td>` : '';
                                            afterRollCell = rowCount === 0 ? `<td style="text-align:right; border:1px solid silver;" rowspan="${rowSpan}">${rowData.afterroll}</td>` : '';
                                            afterTotalCell = rowCount === 0 ? `<td style="text-align:right; border:1px solid silver;" rowspan="${rowSpan}">${rowData.aftertotal}</td>` : '';
                                        } else {
                                            partCell = rowCount === 0 ? `<td style="text-align:center; border:1px solid silver;" rowspan="${rowSpan}">${rowData.part}</td>` : '';
                                            materialNameCell = rowCount === 0 ? `<td style="text-align:center; border:1px solid silver;" rowspan="${rowSpan}">${rowData.materialname}</td>` : '';
                                            classificationCell = rowCount === 0 ? `<td style="text-align:center; border:1px solid silver;" rowspan="${rowSpan}">${rowData.classification}</td>` : '';
                                            materialWidthCell = rowCount === 0 ? `<td style="text-align:right; border:1px solid silver;" rowspan="${rowSpan}">${rowData.materialwidth}</td>` : '';
                                            mCell = rowCount === 0 ? `<td style="text-align:right; border:1px solid silver;" rowspan="${rowSpan}">${rowData.m}</td>` : '';
                                            rollCell = rowCount === 0 ? `<td style="text-align:center; border:1px solid silver;" rowspan="${rowSpan}">${rowData.roll}</td>` : '';
                                            totalCell = rowCount === 0 ? `<td style="text-align:right; border:1px solid silver;" rowspan="${rowSpan}">${rowData.total}</td>` : '';

                                            afterMaterialWidthCell = `<td style="text-align:right; border:1px solid silver; ">${rowData.aftermaterialwidth}</td>`;
                                            afterMCell = `<td style="text-align:right; border:1px solid silver;">${rowData.afterm}</td>`;
                                            afterRollCell = `<td style="text-align:right; border:1px solid silver;">${rowData.afterroll}</td>`;
                                            afterTotalCell = `<td style="text-align:right; border:1px solid silver;">${rowData.aftertotal}</td>`;
                                        }
                                        var trash = `<td style="color:red; border:1px solid silver;">${rowData.trash}</td>`;

                                        var finalMaterialWidthCell = `<td style="text-align:right; border:1px solid silver;">${rowData.finalmaterialwidth === null ? '' : rowData.finalmaterialwidth}</td>`;
                                        var finalMCell = `<td style="text-align:right; border:1px solid silver;">${rowData.finalm === null ? '' : rowData.finalm}</td>`;
                                        var finalRollCell = `<td style="text-align:right; border:1px solid silver;">${rowData.finalroll === null ? '' : rowData.finalroll}</td>`;
                                        var finalTotalCell = `<td style="text-align:right; border:1px solid silver;">${rowData.finaltotal === null ? '' : rowData.finaltotal}</td>`;
                                        var finalTrash = `<td style="color:red; border:1px solid silver;">${rowData.finaltrash === null ? '' : rowData.finaltrash}</td>`;

                                        var inputCell = rowCount === 0 ? `<td style="border:1px solid silver;" rowspan="${rowSpan}"><a class="data-edit1" style="cursor:pointer; color:navy;">실적입력</a></td>` : '';
                                        var idCell = `<td style="color:red;" id="data-id">${rowData.id === null ? '' : rowData.id}</td>`;
                                        var ordernoCell = `<td style="color:red;" id="data-id1">${rowData.orderno === null ? '' : rowData.orderno}</td>`;

                                        $('#materialinputtbody').append(
                                            '<tr>' +
                                            slitingDateCell +
                                            partCell +
                                            materialNameCell +
                                            classificationCell +
                                            materialWidthCell.toLocaleString() +
                                            mCell.toLocaleString() +
                                            rollCell.toLocaleString() +
                                            totalCell.toLocaleString() +
                                            afterMaterialWidthCell.toLocaleString() +
                                            afterMCell.toLocaleString() +
                                            afterRollCell.toLocaleString() +
                                            afterTotalCell.toLocaleString() +
                                            trash +
                                            finalMaterialWidthCell.toLocaleString() +
                                            finalMCell.toLocaleString() +
                                            finalRollCell.toLocaleString() +
                                            finalTotalCell.toLocaleString() +
                                            finalTrash +
                                            inputCell +
                                            idCell +
                                            ordernoCell +
                                            '</tr>'
                                        );
                                        $("td#data-id").hide();
                                        $("td#data-id1").hide();
                                        rowCount++;
                                    }
                                }
                            }
                        }
                    }
                }
            });
        }
        // 이벤트 핸들러를 등록하는 부분


        function groupBySlitingDate(data) {
            var groupedData = {};
            if (!Array.isArray(data)) {
                return groupedData; // Return empty object if data is not an array
            }

            for (var i = 0; i < data.length; i++) {
                var date = data[i].slitingdate;
                var part = data[i].part;
                var materialname = data[i].materialname;
                var orderno = data[i].orderno;
                var groupKey = date + "-" + orderno;

                if (!groupedData[groupKey]) {
                    groupedData[groupKey] = {};
                }

                if (!groupedData[groupKey][part]) {
                    groupedData[groupKey][part] = { rows: [] };
                }

                groupedData[groupKey][part].rows.push(data[i]);
            }

            return groupedData;
        }





        function add() {
            var rowCount = $('#slttable tbody tr').length + 1;

            var newRow = '<tr>' +
                '<td style="border:2px solid whitesmoke;"><input type="text" id="finalmaterialwidth' + rowCount + '"style="width: 100%; height: 100%; text-align: right; font-size: 24px;"  autocomplete="off"></td>' +
                '<td style="border:2px solid whitesmoke;"><input type="text" id="finalm' + rowCount + '"style="width: 100%; height: 100%; text-align: right; font-size: 24px;"  autocomplete="off"></td>' +
                '<td style="border:2px solid whitesmoke;"><input type="text" id="finalroll' + rowCount + '"style="width: 100%; height: 100%; text-align: right; font-size: 24px;"  autocomplete="off"></td>' +
                '<td style="border:2px solid whitesmoke;"><input type="text" id="finalt' + rowCount + '"style="width: 100%; height: 100%; text-align: right; font-size: 24px;"  autocomplete="off"></td>' +

                '</tr>';


            $('#datatable1tbody1').append(newRow);

            // 마지막 행에만 삭제 버튼 생성
            if (rowCount > 1) {
                $('#datatable1tbody tr:nth-child(' + (rowCount - 1) + ') .datalotdelete').remove();
            }
        }

        function add3() {
            var rowCount = $('#slttable1 tbody tr').length + 1;

            var newRow = '<tr>' +
                '<td style="border:2px solid whitesmoke;">' +
                '<select class="afterlotno" id="afterlotno' + rowCount + '"></select>' +
                '</td>' +
                '<td style="border:2px solid whitesmoke;"><input type="text" id="aftermaterialwidth' + rowCount + '"style="width: 100%; height: 100%; text-align: right; font-size: 24px;"  autocomplete="off"></td>' +
                '<td style="border:2px solid whitesmoke;"><input type="text" id="afterm' + rowCount + '"style="width: 100%; height: 100%; text-align: right; font-size: 24px;"  autocomplete="off"></td>' +
                '<td style="border:2px solid whitesmoke;"><input type="text" onkeydown="handleKeyPress1(event)" id="afterroll' + rowCount + '"style="width: 100%; height: 100%; text-align: right; font-size: 24px;"  autocomplete="off"></td>' +
                '<td style="border:2px solid whitesmoke;"><input type="text" id="aftert' + rowCount + '"style="width: 100%; height: 100%; text-align: right; font-size: 24px;"  autocomplete="off"></td>' +
                '</tr>';

            // Append the new row
            $('#datatable1tbody12').append(newRow);

            // Populate the select options with checked values
            $('#sltinputcheckbox:checked').each(function () {
                var afterlotno = $(this).closest('tr').find('td:eq(2)').text();
                var optionHTML = '<option value="' + afterlotno + '">' + afterlotno + '</option>';
                $('#afterlotno' + rowCount).append(optionHTML);
            });

            // 마지막 행에만 삭제 버튼 생성
            if (rowCount > 1) {
                $('#datatable1tbody12 tr:nth-child(' + (rowCount - 1) + ') .datalotdelete').remove();
            }
        }

        function add4() {
            var rowCount = $('#slttable2 tbody tr').length + 1;

            var newRow = '<tr>' +
                '<td style="border:2px solid whitesmoke;"><input type="text" id="habji-aftermaterialwidth' + rowCount + '"style="width: 100%; height: 100%; text-align: right; font-size: 24px;"  autocomplete="off"></td>' +
                '<td style="border:2px solid whitesmoke;"><input type="text" id="habji-afterm' + rowCount + '"style="width: 100%; height: 100%; text-align: right; font-size: 24px;"  autocomplete="off"></td>' +
                '<td style="border:2px solid whitesmoke;"><input type="text" id="habji-afterroll' + rowCount + '"style="width: 100%; height: 100%; text-align: right; font-size: 24px;"  autocomplete="off"></td>' +
                '<td style="border:2px solid whitesmoke;"><input type="text" id="habji-aftert' + rowCount + '"style="width: 100%; height: 100%; text-align: right; font-size: 24px;"  autocomplete="off"></td>' +

                '</tr>';


            $('#datatable1tbody123').append(newRow);

            // 마지막 행에만 삭제 버튼 생성
            if (rowCount > 1) {
                $('#datatable1tbody tr:nth-child(' + (rowCount - 1) + ') .datalotdelete').remove();
            }
        }


        // afterm1 입력 필드에 대한 keydown 이벤트 핸들러 등록
        function handleKeyPress1(event) {
            if (event.keyCode === 13) {
                var afterM1Value = parseFloat($('#afterm1').val()) || 0;
                var afterRoll1Value = parseFloat($('#afterroll1').val()) || 0;

                // 계산
                var afterT1Value = afterM1Value * afterRoll1Value;

                // 결과값을 해당 엘리먼트에 할당
                $('#aftert1').val(afterT1Value);
            }
        }


    </script>

</body>

</html>