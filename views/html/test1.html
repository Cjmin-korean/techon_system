<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css"
        href="https://cdn.datatables.net/buttons/2.0.1/css/buttons.dataTables.min.css">
    <link rel="stylesheet" type="text/css"
        href="https://cdn.datatables.net/responsive/2.2.9/css/responsive.dataTables.min.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto|Varela+Round" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.4/css/jquery.dataTables.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/select/1.3.4/css/select.dataTables.min.css">

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.4/js/jquery.dataTables.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>

    <script type="text/javascript"
        src="https://cdn.datatables.net/responsive/2.2.9/js/dataTables.responsive.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/select/1.3.4/js/dataTables.select.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/vfs_fonts.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/2.0.1/js/dataTables.buttons.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/2.0.1/js/buttons.html5.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/2.0.1/js/buttons.print.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/2.0.1/js/buttons.colVis.min.js"></script>
</head>
<style>

</style>

<body>
    <!-- 파일 선택 창 -->
    <input type="file" id="fileInput">

    <!-- 저장 버튼 -->
    <button onclick="saveData()">저장</button>
</body>

<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
<script>
    function saveData() {
        const fileInput = document.getElementById('fileInput');
        const file = fileInput.files[0];

        if (!file) {
            console.error('파일을 선택하세요.');
            return;
        }

        const reader = new FileReader();
        reader.readAsArrayBuffer(file);

        reader.onload = function () {
            const arrayBuffer = reader.result;
            const uint8Array = new Uint8Array(arrayBuffer);

            const xhr = new XMLHttpRequest();
            xhr.open('POST', 'http://localhost:8080/api/savefile');
            xhr.setRequestHeader('Content-Type', 'application/json');
            
            xhr.onload = function () {
                if (xhr.status === 200) {
                    console.log('데이터 저장 완료');
                } else {
                    console.error('서버 오류');
                }
            };
     
            xhr.send(JSON.stringify({ filename: file.name, filedata: uint8Array }));
        };
    }


    // function saveData() {
    //     // 파일 선택 창에서 선택한 파일 가져오기
    //     const fileInput = document.getElementById('fileInput');
    //     const file = fileInput.files[0];

    //     // 엑셀 파일 읽기
    //     const reader = new FileReader();
    //     reader.readAsBinaryString(file);
    //     reader.onload = function (event) {
    //         const data = event.target.result;
    //         const workbook = XLSX.read(data, { type: 'binary' });

    //         // 첫 번째 시트 선택
    //         const sheet = workbook.Sheets[workbook.SheetNames[0]];

    //         // 시트 데이터가 있는 범위 구하기
    //         const range = XLSX.utils.decode_range(sheet['!ref']);

    //         // 시트 데이터가 있는 셀의 개수 구하기
    //         const rowCount = range.e.r - range.s.r + 1;

    //         // A1 셀의 데이터 추출
    //         for (let i = 1; i <= rowCount; i++) {
    //             const data1 = sheet['A' + i].v;

    //             // 서버로 데이터 전송
    //             const xhr = new XMLHttpRequest();
    //             xhr.open('POST', 'http://localhost:8080/api/abcd');
    //             xhr.setRequestHeader('Content-Type', 'application/json');
    //             xhr.onload = function () {
    //                 if (xhr.status === 200) {
    //                     console.log('데이터 저장 완료');
    //                 } else {
    //                     console.error('서버 오류');
    //                 }
    //             };
    //             xhr.send(JSON.stringify({ data1: data1 }));
    //         }


    //     };




</script>

</html>