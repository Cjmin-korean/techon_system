<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="../css/mesmain.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="../js/sorttable.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css" rel="stylesheet" />


</head>
<style>
    #Datatbody td {
        height: 30px;

    }

    .table-container {
        max-height: 900px;
        display: flex;
    }

    .styled-table {
        /* Add any additional styles for the table here */
        width: 100%;
    }

    #datatable-left {
        flex: 1;
    }

    #datatable-right {
        flex: 1;
    }

    #datatable-right th {
        text-align: center;
    }
</style>


<body>
    <div class="main_header">
        <img src="/img/테크온로고.PNG" style="width: 100px;" class="loadingImage">
        <a style="margin-left: 20px;">설비관리대장</a>
    </div>
    <div id="loadingOverlay">
        <img src="/img/테크온로고.PNG" alt="로딩 이미지" class="loadingImage">

    </div>

    <div id="overlay"></div>
    <div class="table-container">

        <table class="styled-table" id="datatable-left">
            <thead id="tableHead">

                <th style="text-align:center;" onclick="sortTable(0)">설비코드</th>
                <th style="text-align:center;" onclick="sortTable(1)">호기명</th>
                <th style="text-align:center;" onclick="sortTable(2)">설비명</th>
                <th style="text-align:center;" onclick="sortTable(3)">구분</th>
                <th style="text-align:center;" onclick="sortTable(4)">규격</th>
                <th style="text-align:center;" onclick="sortTable(5)">차수</th>
                <th style="text-align:center;" onclick="sortTable(6)">설비제작업체</th>
                <th style="text-align:center;" onclick="sortTable(7)">SERIAL NO</th>
                <th style="text-align:center;" onclick="sortTable(8)">제작일</th>

            </thead>
            <tbody id="Datatbody">

            </tbody>
        </table>

        <div id="datatable-right">
            <table class="styled-table">
                <thead id="tableHead">
                    <tr>
                        <th style="text-align:center;" colspan="4">설비 이력 대장</th>
                    </tr>
                    <tr>
                        <th style="text-align: center;">설비번호</th>
                        <td style="text-align: center;" id="codenumber"></td>
                        <td rowspan="5" colspan="3" style="text-align: center;"> <img alt=""  class="loadingImage"
                                style="width:80%; height: 80%;" id="img"></td>
                    </tr>
                    <tr>
                        <th style="text-align: center;">설비명</th>
                        <td style="text-align: center;" id="eqname"></td>
                    </tr>

                    <tr>
                        <th style="text-align: center;">제작일</th>
                        <td style="text-align: center;" id="manudate"></td>
                    </tr>
                    <tr>
                        <th style="text-align: center;">제작회사</th>
                        <td style="text-align: center;" id="customer"></td>
                    </tr>
                    <tr>
                        <th style="text-align: center;">S/N</th>
                        <td style="text-align: center;" id="serialno"></td>
                    </tr>
                    <tr>
                        <th style="text-align:center;">고장내용</th>
                        <th style="text-align:center;">조치내용</th>
                        <th style="text-align:center;">발생일</th>
                        <th style="text-align:center;">조치일</th>
                    </tr>

                </thead>
                <tbody id="Datatbody">
                    <tr>
                        <td>피딩롤러 끝 센서 누락</td>
                        <td>근접 센서 설치 (25만원)</td>
                        <td>200818 </td>
                        <td>200819</td>
                    </tr>
                </tbody>
            </table>
        </div>

    </div>

    <script>
        var server = '';

        if (window.location.hostname == 'localhost') {
            server = 'http://localhost:8080';
        } else {
            server = 'http://techonmes.co.kr';
        }
        $(document).ready(function () {

            showLoading()
            load()


        });


        function showLoading() {
            var loadingOverlay = document.getElementById("loadingOverlay");
            loadingOverlay.style.display = "flex";
            setTimeout(function () {
                loadingOverlay.style.display = "none";
            }, 1000);
        }







        function load() {
            $('#Datatbody').empty();

            $.ajax({
                type: 'POST',
                url: server + '/api/equipment',
                dataType: 'json',
                success: function (data) {
                    if (data.length === 0) {
                        // Handle empty data case if needed
                    } else {
                        for (var i = 0; i < data.length; i++) {
                            var row = $('<tr>').attr('data-row-index', i); // Add data-row-index attribute

                            // Append data to the row
                            row.append('<td>' + (data[i].codenumber || '') + '</td>');
                            row.append('<td>' + (data[i].equipmentname || '') + '</td>');
                            row.append('<td>' + (data[i].eqname || '') + '</td>');
                            row.append('<td>' + (data[i].part || '') + '</td>');
                            row.append('<td>' + (data[i].size || '') + '</td>');
                            row.append('<td>' + (data[i].num || '') + '</td>');
                            row.append('<td>' + (data[i].customer || '') + '</td>');
                            row.append('<td>' + (data[i].serialno || '') + '</td>');
                            row.append('<td>' + (data[i].manudate || '') + '</td>');

                            // Append the row to the table body
                            $('#Datatbody').append(row);
                        }

                        // Add click event to the rows
                        $('#Datatbody tr').dblclick(function () {
                            var rowIndex = $(this).data('row-index');
                            var rowData = data[rowIndex];
                            $('#codenumber').text(rowData.codenumber);
                            $('#eqname').text(rowData.eqname);
                            $('#manudate').text(rowData.manudate);
                            $('#customer').text(rowData.customer);
                            $('#serialno').text(rowData.serialno);
                            $('#serialno').text(rowData.serialno);
                            $('#img').attr('src', '../marchineimage/' + rowData.codenumber + '.PNG');
                        });
                    }
                }
            });
        }





    </script>


</body>

</html>