<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Data Table</title>
    <script data-require="jquery@2.0.3" data-semver="2.0.3" src="http://code.jquery.com/jquery-2.0.3.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
            padding: 20px;
        }

        table.grid {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background-color: white;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        table.grid thead {
            position: sticky;
            top: 0;
            z-index: 1;
        }

        table.grid tbody {
            display: block;
            max-height: 80vh;
            overflow-y: auto;
        }

        table.grid thead tr td {
            background-color: #d9dce2;
            color: rgb(0, 0, 0);
            font-weight: bold;
            padding: 10px;
            position: relative;
            /* cursor: pointer; */
            text-align: left;
            border: 1px solid #ddd;
        }

        table.grid tbody tr:nth-child(odd) {
            background-color: #eef0f5;
        }

        table.grid tbody tr td {
            padding: 5px;
            /* Adjusted padding to make the rows wider */
            border: 1px solid #ddd;
        }

        table.grid thead,
        table.grid tbody tr {
            display: table;
            width: 100%;
            table-layout: fixed;
            padding: 10px;
            /* Ensures columns are of equal width */
        }

        .filter {
            position: absolute;
            border: solid 1px #ddd;
            top: 35px;
            background-color: white;
            width: 200px;
            max-height: 400px;
            overflow-y: auto;
            right: 0;
            display: none;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            z-index: 10;
        }

        .filter .filter-content {
            overflow-y: auto;
            /* Allows scrolling for the checkbox list */
            flex-grow: 1;
        }

        .filter .filter-actions {
            padding: 5px;
            border-top: 1px solid #ddd;
            background-color: white;
            display: flex;
            justify-content: flex-end;
            /* Aligns buttons to the right */
        }

        .filter div {
            padding: 5px;
        }

        .filter div input[type="checkbox"] {
            margin-right: 10px;
            transform: scale(1.5);
            /* ì²´í¬ë°•ìŠ¤ í¬ê¸° í™•ëŒ€ */
        }

        .filter .filter-actions input[type="button"] {
            margin-left: 5px;
            padding: 5px 10px;
            border: none;
            color: white;
            cursor: pointer;
            border-radius: 3px;
        }

        .filter div input[type="button"] {
            margin: 5px;
            padding: 5px 10px;
            border: none;
            background-color: #4CAF50;
            color: white;
            cursor: pointer;
            border-radius: 3px;
        }


        .filter .filter-actions input#ok {
            background-color: #4531b6;
            /* Green for OK */
        }

        .filter .filter-actions input#ok:hover {
            background-color: #2c0e70;
        }

        .filter .filter-actions input#close {
            background-color: #f44336;
            /* Red for Cancel */
        }

        .filter .filter-actions input#close:hover {
            background-color: #e53935;
        }

        .filter-button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            /* color: white; */
            border: none;
            border-radius: 20%;
            padding: 5px;
            cursor: pointer;
            font-size: 14px;
            width: 20px;
            height: 20px;
            float: right;
        }

        .filter-button:hover {
            /* background-color: #45a049; */
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
        }

        .filter-icon {
            font-size: 20px;
            margin: 0;
        }
    </style>
</head>

<body>
    <h1>Customer information</h1>
    <table class="grid">
        <thead>
            <tr>
                <td index="0" style="text-align: center;">TÃªn nhÃ  cung cáº¥p<br>ê±°ë˜ì²˜ëª…
                    <div class="filter"></div>
                </td>
                <td index="1" style="text-align: center;">Sá»‘ Ä‘Äƒng kÃ½ kinh doanh<br>ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸
                    <div class="filter"></div>
                </td>
                <td index="2" style="text-align: center;">TÃªn ngÆ°á»i Ä‘áº¡i diá»‡n<br>ëŒ€í‘œìëª…
                    <div class="filter"></div>
                </td>
                <td index="3" style="text-align: center;">IN
                    <div class="filter"></div>
                </td>

            </tr>
        </thead>
        <tbody id="Datatbody">

        </tbody>
    </table>
</body>

<script>
    var server = '';
    if (window.location.hostname === '127.0.0.1' || window.location.hostname === 'localhost') {
        server = 'http://localhost:8080';
    } else {
        server = 'https://mestechon.com';
    }


    $(document).ready(function () {
        $(".grid thead td").append('<button style="float:right; " class="filter-button"><span class="filter-icon">ğŸ”</span></button>'); // Add filter button to each header
        $(".filter-button").click(function (e) {
            e.stopPropagation();
            showFilterOption(this);
        });

        $(".grid thead td").not('.filtered-column').click(function () {
            groupData(this);
        });
        load();
    });
    function load() {
        $('#Datatbody').empty();
        $.ajax({
            type: 'POST',
            url: server + '/api/selectcustomerinfovina',
            dataType: 'json',
            success: function (data) {
                if (data.length === 0) {
                    $('#Datatbody').append(
                        '<tr><td colspan="13" style="text-align:center;">KhÃ´ng cÃ³ dá»¯ liá»‡u(ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤)</td></tr>'
                    );
                } else {
                    for (var i = 0; i < data.length; i++) {

                        var rowData = JSON.stringify(data[i]);

                        $('#Datatbody').append(
                            '<tr>' +
                            '<td>' + data[i].customername + '</td>' +
                            '<td>' + data[i].businessregistrationnumber + '</td>' +
                            '<td>' + data[i].representativename + '</td>' +
                            '<td>' + data[i].initial + '</td>' +
                            '<td id="data-id" style="display:none;">' + data[i].id + '</td>' +
                            // '<td><button class="btn btn-primary" onclick=\'showinfo(' + rowData + ')\'>Info</button></td>' +
                            '</tr>'
                        );
                    }
                }
            }
        });
    }


    var arrayMap = {};

    function showFilterOption(button) {
        var tdObject = $(button).parent();
        var filterGrid = $(tdObject).find(".filter");

        if (filterGrid.is(":visible")) {
            filterGrid.hide();
            return;
        }

        $(".filter").hide();

        var index = 0;
        filterGrid.empty();
        var allSelected = true;
        filterGrid.append('<div><input id="all" type="checkbox" checked>Select All</div>');

        var $rows = $(tdObject).parents("table").find("tbody tr");
        var uniqueValues = {}; // Object to store unique values

        $rows.each(function (ind, ele) {
            var currentTd = $(ele).children()[$(tdObject).attr("index")];
            var text = currentTd.innerHTML;

            // Store unique values
            if (!uniqueValues[text]) {
                uniqueValues[text] = true;
                var div = document.createElement("div");
                div.classList.add("grid-item");
                var str = $(ele).is(":visible") ? 'checked' : '';
                if ($(ele).is(":hidden")) {
                    allSelected = false;
                }
                div.innerHTML = '<input type="checkbox" ' + str + ' >' + text;
                filterGrid.append(div);
                arrayMap[index] = ele;
                index++;
            }
        });

        if (!allSelected) {
            filterGrid.find("#all").removeAttr("checked");
        }

        filterGrid.append('<div><input id="close" type="button" value="Close"/><input id="ok" type="button" value="Ok"/></div>');
        filterGrid.show();

        var $closeBtn = filterGrid.find("#close");
        var $okBtn = filterGrid.find("#ok");
        var $checkElems = filterGrid.find("input[type='checkbox']");
        var $gridItems = filterGrid.find(".grid-item");
        var $all = filterGrid.find("#all");

        $closeBtn.click(function () {
            filterGrid.hide();
            return false;
        });

        $okBtn.click(function () {
            var filterApplied = false;
            filterGrid.find(".grid-item").each(function (ind, ele) {
                if ($(ele).find("input").is(":checked")) {
                    $(arrayMap[ind]).show();
                } else {
                    $(arrayMap[ind]).hide();
                    filterApplied = true; // í•„í„°ê°€ ì ìš©ëœ ê²ƒìœ¼ë¡œ í‘œì‹œ
                }
            });

            if (filterApplied) {
                tdObject.addClass("filtered-column"); // í•„í„°ê°€ ì ìš©ëœ ì»¬ëŸ¼ì— í‘œì‹œ ì¶”ê°€
                tdObject.append('<span class="filter-icon">&#x1F50D;</span>'); // í•„í„° ì•„ì´ì½˜ ì¶”ê°€
            } else {
                tdObject.removeClass("filtered-column"); // í•„í„° í•´ì œ ì‹œ í‘œì‹œ ì œê±°
                tdObject.find(".filter-icon").remove(); // í•„í„° ì•„ì´ì½˜ ì œê±°
            }

            filterGrid.hide();
            return false;
        });

        $checkElems.click(function (event) {
            event.stopPropagation();
        });

        $gridItems.click(function (event) {
            var chk = $(this).find("input[type='checkbox']");
            $(chk).prop("checked", !$(chk).is(":checked"));
        });

        $all.change(function () {
            var chked = $(this).is(":checked");
            filterGrid.find(".grid-item [type='checkbox']").prop("checked", chked);
        });

        filterGrid.click(function (event) {
            event.stopPropagation();
        });

        return filterGrid;
    }

    function groupData(tdObject) {
        var index = $(tdObject).attr("index");
        var $rows = $(tdObject).parents("table").find("tbody tr:visible");
        var uniqueValues = {};

        $rows.each(function () {
            var cellValue = $(this).children().eq(index).text();
            if (uniqueValues[cellValue]) {
                $(this).hide(); // ë™ì¼í•œ ê°’ì´ ì´ë¯¸ ì¡´ì¬í•˜ë©´ ìˆ¨ê¸°ê¸°
            } else {
                uniqueValues[cellValue] = true;
            }
        });
    }
</script>

</html>